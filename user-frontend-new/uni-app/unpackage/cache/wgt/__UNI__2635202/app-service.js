if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((a=>t.resolve(e()).then((()=>a))),(a=>t.resolve(e()).then((()=>{throw a}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...a){uni.__log__?uni.__log__(e,t,...a):console[e].apply(console,[...a,t])}function a(e,t){return"string"==typeof e?t:e}const n=t=>(a,n=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,a,n)},o=n("onShow"),r=n("onLoad");function s(e,t){return function(){return e.apply(t,arguments)}}const{toString:i}=Object.prototype,{getPrototypeOf:l}=Object,c=(e=>t=>{const a=i.call(t);return e[a]||(e[a]=a.slice(8,-1).toLowerCase())})(Object.create(null)),d=e=>(e=e.toLowerCase(),t=>c(t)===e),u=e=>t=>typeof t===e,{isArray:m}=Array,p=u("undefined");const g=d("ArrayBuffer");const h=u("string"),f=u("function"),v=u("number"),y=e=>null!==e&&"object"==typeof e,w=e=>{if("object"!==c(e))return!1;const t=l(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)},E=d("Date"),b=d("File"),k=d("Blob"),N=d("FileList"),S=d("URLSearchParams"),[V,C,x,T]=["ReadableStream","Request","Response","Headers"].map(d);function B(e,t,{allOwnKeys:a=!1}={}){if(null==e)return;let n,o;if("object"!=typeof e&&(e=[e]),m(e))for(n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else{const o=a?Object.getOwnPropertyNames(e):Object.keys(e),r=o.length;let s;for(n=0;n<r;n++)s=o[n],t.call(null,e[s],s,e)}}function R(e,t){t=t.toLowerCase();const a=Object.keys(e);let n,o=a.length;for(;o-- >0;)if(n=a[o],t===n.toLowerCase())return n;return null}const P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,O=e=>!p(e)&&e!==P;const A=(e=>t=>e&&t instanceof e)("undefined"!=typeof Uint8Array&&l(Uint8Array)),D=d("HTMLFormElement"),F=(({hasOwnProperty:e})=>(t,a)=>e.call(t,a))(Object.prototype),_=d("RegExp"),$=(e,t)=>{const a=Object.getOwnPropertyDescriptors(e),n={};B(a,((a,o)=>{let r;!1!==(r=t(a,o,e))&&(n[o]=r||a)})),Object.defineProperties(e,n)};const L=d("AsyncFunction"),M=(I="function"==typeof setImmediate,U=f(P.postMessage),I?setImmediate:U?(j=`axios@${Math.random()}`,z=[],P.addEventListener("message",(({source:e,data:t})=>{e===P&&t===j&&z.length&&z.shift()()}),!1),e=>{z.push(e),P.postMessage(j,"*")}):e=>setTimeout(e));var I,U,j,z;const q="undefined"!=typeof queueMicrotask?queueMicrotask.bind(P):"undefined"!=typeof process&&process.nextTick||M,H={isArray:m,isArrayBuffer:g,isBuffer:function(e){return null!==e&&!p(e)&&null!==e.constructor&&!p(e.constructor)&&f(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||f(e.append)&&("formdata"===(t=c(e))||"object"===t&&f(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&g(e.buffer),t},isString:h,isNumber:v,isBoolean:e=>!0===e||!1===e,isObject:y,isPlainObject:w,isReadableStream:V,isRequest:C,isResponse:x,isHeaders:T,isUndefined:p,isDate:E,isFile:b,isBlob:k,isRegExp:_,isFunction:f,isStream:e=>y(e)&&f(e.pipe),isURLSearchParams:S,isTypedArray:A,isFileList:N,forEach:B,merge:function e(){const{caseless:t}=O(this)&&this||{},a={},n=(n,o)=>{const r=t&&R(a,o)||o;w(a[r])&&w(n)?a[r]=e(a[r],n):w(n)?a[r]=e({},n):m(n)?a[r]=n.slice():a[r]=n};for(let o=0,r=arguments.length;o<r;o++)arguments[o]&&B(arguments[o],n);return a},extend:(e,t,a,{allOwnKeys:n}={})=>(B(t,((t,n)=>{a&&f(t)?e[n]=s(t,a):e[n]=t}),{allOwnKeys:n}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,a,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),a&&Object.assign(e.prototype,a)},toFlatObject:(e,t,a,n)=>{let o,r,s;const i={};if(t=t||{},null==e)return t;do{for(o=Object.getOwnPropertyNames(e),r=o.length;r-- >0;)s=o[r],n&&!n(s,e,t)||i[s]||(t[s]=e[s],i[s]=!0);e=!1!==a&&l(e)}while(e&&(!a||a(e,t))&&e!==Object.prototype);return t},kindOf:c,kindOfTest:d,endsWith:(e,t,a)=>{e=String(e),(void 0===a||a>e.length)&&(a=e.length),a-=t.length;const n=e.indexOf(t,a);return-1!==n&&n===a},toArray:e=>{if(!e)return null;if(m(e))return e;let t=e.length;if(!v(t))return null;const a=new Array(t);for(;t-- >0;)a[t]=e[t];return a},forEachEntry:(e,t)=>{const a=(e&&e[Symbol.iterator]).call(e);let n;for(;(n=a.next())&&!n.done;){const a=n.value;t.call(e,a[0],a[1])}},matchAll:(e,t)=>{let a;const n=[];for(;null!==(a=e.exec(t));)n.push(a);return n},isHTMLForm:D,hasOwnProperty:F,hasOwnProp:F,reduceDescriptors:$,freezeMethods:e=>{$(e,((t,a)=>{if(f(e)&&-1!==["arguments","caller","callee"].indexOf(a))return!1;const n=e[a];f(n)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+a+"'")}))}))},toObjectSet:(e,t)=>{const a={},n=e=>{e.forEach((e=>{a[e]=!0}))};return m(e)?n(e):n(String(e).split(t)),a},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,a){return t.toUpperCase()+a})),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:R,global:P,isContextDefined:O,isSpecCompliantForm:function(e){return!!(e&&f(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const t=new Array(10),a=(e,n)=>{if(y(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[n]=e;const o=m(e)?[]:{};return B(e,((e,t)=>{const r=a(e,n+1);!p(r)&&(o[t]=r)})),t[n]=void 0,o}}return e};return a(e,0)},isAsyncFn:L,isThenable:e=>e&&(y(e)||f(e))&&f(e.then)&&f(e.catch),setImmediate:M,asap:q};function W(e,t,a,n,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),a&&(this.config=a),n&&(this.request=n),o&&(this.response=o,this.status=o.status?o.status:null)}H.inherits(W,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const Y=W.prototype,J={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((e=>{J[e]={value:e}})),Object.defineProperties(W,J),Object.defineProperty(Y,"isAxiosError",{value:!0}),W.from=(e,t,a,n,o,r)=>{const s=Object.create(Y);return H.toFlatObject(e,s,(function(e){return e!==Error.prototype}),(e=>"isAxiosError"!==e)),W.call(s,e.message,t,a,n,o),s.cause=e,s.name=e.name,r&&Object.assign(s,r),s};function X(e){return H.isPlainObject(e)||H.isArray(e)}function K(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function G(e,t,a){return e?e.concat(t).map((function(e,t){return e=K(e),!a&&t?"["+e+"]":e})).join(a?".":""):t}const Z=H.toFlatObject(H,{},null,(function(e){return/^is[A-Z]/.test(e)}));function Q(e,t,a){if(!H.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const n=(a=H.toFlatObject(a,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!H.isUndefined(t[e])}))).metaTokens,o=a.visitor||c,r=a.dots,s=a.indexes,i=(a.Blob||"undefined"!=typeof Blob&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(o))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(H.isDate(e))return e.toISOString();if(!i&&H.isBlob(e))throw new W("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(e)||H.isTypedArray(e)?i&&"function"==typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,a,o){let i=e;if(e&&!o&&"object"==typeof e)if(H.endsWith(a,"{}"))a=n?a:a.slice(0,-2),e=JSON.stringify(e);else if(H.isArray(e)&&function(e){return H.isArray(e)&&!e.some(X)}(e)||(H.isFileList(e)||H.endsWith(a,"[]"))&&(i=H.toArray(e)))return a=K(a),i.forEach((function(e,n){!H.isUndefined(e)&&null!==e&&t.append(!0===s?G([a],n,r):null===s?a:a+"[]",l(e))})),!1;return!!X(e)||(t.append(G(o,a,r),l(e)),!1)}const d=[],u=Object.assign(Z,{defaultVisitor:c,convertValue:l,isVisitable:X});if(!H.isObject(e))throw new TypeError("data must be an object");return function e(a,n){if(!H.isUndefined(a)){if(-1!==d.indexOf(a))throw Error("Circular reference detected in "+n.join("."));d.push(a),H.forEach(a,(function(a,r){!0===(!(H.isUndefined(a)||null===a)&&o.call(t,a,H.isString(r)?r.trim():r,n,u))&&e(a,n?n.concat(r):[r])})),d.pop()}}(e),t}function ee(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function te(e,t){this._pairs=[],e&&Q(e,this,t)}const ae=te.prototype;function ne(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function oe(e,t,a){if(!t)return e;const n=a&&a.encode||ne;H.isFunction(a)&&(a={serialize:a});const o=a&&a.serialize;let r;if(r=o?o(t,a):H.isURLSearchParams(t)?t.toString():new te(t,a).toString(n),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}ae.append=function(e,t){this._pairs.push([e,t])},ae.toString=function(e){const t=e?function(t){return e.call(this,t,ee)}:ee;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};class re{constructor(){this.handlers=[]}use(e,t,a){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!a&&a.synchronous,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}const se={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ie={isBrowser:!0,classes:{URLSearchParams:"undefined"!=typeof URLSearchParams?URLSearchParams:te,FormData:"undefined"!=typeof FormData?FormData:null,Blob:"undefined"!=typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},le="undefined"!=typeof window&&"undefined"!=typeof document,ce="object"==typeof navigator&&navigator||void 0,de=le&&(!ce||["ReactNative","NativeScript","NS"].indexOf(ce.product)<0),ue="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,me=le&&window.location.href||"http://localhost",pe={...Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:le,hasStandardBrowserEnv:de,hasStandardBrowserWebWorkerEnv:ue,navigator:ce,origin:me},Symbol.toStringTag,{value:"Module"})),...ie};function ge(e){function t(e,a,n,o){let r=e[o++];if("__proto__"===r)return!0;const s=Number.isFinite(+r),i=o>=e.length;if(r=!r&&H.isArray(n)?n.length:r,i)return H.hasOwnProp(n,r)?n[r]=[n[r],a]:n[r]=a,!s;n[r]&&H.isObject(n[r])||(n[r]=[]);return t(e,a,n[r],o)&&H.isArray(n[r])&&(n[r]=function(e){const t={},a=Object.keys(e);let n;const o=a.length;let r;for(n=0;n<o;n++)r=a[n],t[r]=e[r];return t}(n[r])),!s}if(H.isFormData(e)&&H.isFunction(e.entries)){const a={};return H.forEachEntry(e,((e,n)=>{t(function(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map((e=>"[]"===e[0]?"":e[1]||e[0]))}(e),n,a,0)})),a}return null}const he={transitional:se,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const a=t.getContentType()||"",n=a.indexOf("application/json")>-1,o=H.isObject(e);o&&H.isHTMLForm(e)&&(e=new FormData(e));if(H.isFormData(e))return n?JSON.stringify(ge(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(o){if(a.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return Q(e,new pe.classes.URLSearchParams,Object.assign({visitor:function(e,t,a,n){return pe.isNode&&H.isBuffer(e)?(this.append(t,e.toString("base64")),!1):n.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=H.isFileList(e))||a.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return Q(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return o||n?(t.setContentType("application/json",!1),function(e,t,a){if(H.isString(e))try{return(t||JSON.parse)(e),H.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(a||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||he.transitional,a=t&&t.forcedJSONParsing,n="json"===this.responseType;if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(a&&!this.responseType||n)){const a=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(o){if(a){if("SyntaxError"===o.name)throw W.from(o,W.ERR_BAD_RESPONSE,this,null,this.response);throw o}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],(e=>{he.headers[e]={}}));const fe=he,ve=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ye=Symbol("internals");function we(e){return e&&String(e).trim().toLowerCase()}function Ee(e){return!1===e||null==e?e:H.isArray(e)?e.map(Ee):String(e)}function be(e,t,a,n,o){return H.isFunction(n)?n.call(this,t,a):(o&&(t=a),H.isString(t)?H.isString(n)?-1!==t.indexOf(n):H.isRegExp(n)?n.test(t):void 0:void 0)}class ke{constructor(e){e&&this.set(e)}set(e,t,a){const n=this;function o(e,t,a){const o=we(t);if(!o)throw new Error("header name must be a non-empty string");const r=H.findKey(n,o);(!r||void 0===n[r]||!0===a||void 0===a&&!1!==n[r])&&(n[r||t]=Ee(e))}const r=(e,t)=>H.forEach(e,((e,a)=>o(e,a,t)));if(H.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(H.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))r((e=>{const t={};let a,n,o;return e&&e.split("\n").forEach((function(e){o=e.indexOf(":"),a=e.substring(0,o).trim().toLowerCase(),n=e.substring(o+1).trim(),!a||t[a]&&ve[a]||("set-cookie"===a?t[a]?t[a].push(n):t[a]=[n]:t[a]=t[a]?t[a]+", "+n:n)})),t})(e),t);else if(H.isHeaders(e))for(const[s,i]of e.entries())o(i,s,a);else null!=e&&o(t,e,a);return this}get(e,t){if(e=we(e)){const a=H.findKey(this,e);if(a){const e=this[a];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),a=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=a.exec(e);)t[n[1]]=n[2];return t}(e);if(H.isFunction(t))return t.call(this,e,a);if(H.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=we(e)){const a=H.findKey(this,e);return!(!a||void 0===this[a]||t&&!be(0,this[a],a,t))}return!1}delete(e,t){const a=this;let n=!1;function o(e){if(e=we(e)){const o=H.findKey(a,e);!o||t&&!be(0,a[o],o,t)||(delete a[o],n=!0)}}return H.isArray(e)?e.forEach(o):o(e),n}clear(e){const t=Object.keys(this);let a=t.length,n=!1;for(;a--;){const o=t[a];e&&!be(0,this[o],o,e,!0)||(delete this[o],n=!0)}return n}normalize(e){const t=this,a={};return H.forEach(this,((n,o)=>{const r=H.findKey(a,o);if(r)return t[r]=Ee(n),void delete t[o];const s=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,((e,t,a)=>t.toUpperCase()+a))}(o):String(o).trim();s!==o&&delete t[o],t[s]=Ee(n),a[s]=!0})),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return H.forEach(this,((a,n)=>{null!=a&&!1!==a&&(t[n]=e&&H.isArray(a)?a.join(", "):a)})),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map((([e,t])=>e+": "+t)).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const a=new this(e);return t.forEach((e=>a.set(e))),a}static accessor(e){const t=(this[ye]=this[ye]={accessors:{}}).accessors,a=this.prototype;function n(e){const n=we(e);t[n]||(!function(e,t){const a=H.toCamelCase(" "+t);["get","set","has"].forEach((n=>{Object.defineProperty(e,n+a,{value:function(e,a,o){return this[n].call(this,t,e,a,o)},configurable:!0})}))}(a,e),t[n]=!0)}return H.isArray(e)?e.forEach(n):n(e),this}}ke.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),H.reduceDescriptors(ke.prototype,(({value:e},t)=>{let a=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[a]=e}}})),H.freezeMethods(ke);const Ne=ke;function Se(e,t){const a=this||fe,n=t||a,o=Ne.from(n.headers);let r=n.data;return H.forEach(e,(function(e){r=e.call(a,r,o.normalize(),t?t.status:void 0)})),o.normalize(),r}function Ve(e){return!(!e||!e.__CANCEL__)}function Ce(e,t,a){W.call(this,null==e?"canceled":e,W.ERR_CANCELED,t,a),this.name="CanceledError"}function xe(e,t,a){const n=a.config.validateStatus;a.status&&n&&!n(a.status)?t(new W("Request failed with status code "+a.status,[W.ERR_BAD_REQUEST,W.ERR_BAD_RESPONSE][Math.floor(a.status/100)-4],a.config,a.request,a)):e(a)}H.inherits(Ce,W,{__CANCEL__:!0});const Te=(e,t,a=3)=>{let n=0;const o=function(e,t){e=e||10;const a=new Array(e),n=new Array(e);let o,r=0,s=0;return t=void 0!==t?t:1e3,function(i){const l=Date.now(),c=n[s];o||(o=l),a[r]=i,n[r]=l;let d=s,u=0;for(;d!==r;)u+=a[d++],d%=e;if(r=(r+1)%e,r===s&&(s=(s+1)%e),l-o<t)return;const m=c&&l-c;return m?Math.round(1e3*u/m):void 0}}(50,250);return function(e,t){let a,n,o=0,r=1e3/t;const s=(t,r=Date.now())=>{o=r,a=null,n&&(clearTimeout(n),n=null),e.apply(null,t)};return[(...e)=>{const t=Date.now(),i=t-o;i>=r?s(e,t):(a=e,n||(n=setTimeout((()=>{n=null,s(a)}),r-i)))},()=>a&&s(a)]}((a=>{const r=a.loaded,s=a.lengthComputable?a.total:void 0,i=r-n,l=o(i);n=r;e({loaded:r,total:s,progress:s?r/s:void 0,bytes:i,rate:l||void 0,estimated:l&&s&&r<=s?(s-r)/l:void 0,event:a,lengthComputable:null!=s,[t?"download":"upload"]:!0})}),a)},Be=(e,t)=>{const a=null!=e;return[n=>t[0]({lengthComputable:a,total:e,loaded:n}),t[1]]},Re=e=>(...t)=>H.asap((()=>e(...t))),Pe=pe.hasStandardBrowserEnv?((e,t)=>a=>(a=new URL(a,pe.origin),e.protocol===a.protocol&&e.host===a.host&&(t||e.port===a.port)))(new URL(pe.origin),pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent)):()=>!0,Oe=pe.hasStandardBrowserEnv?{write(e,t,a,n,o,r){const s=[e+"="+encodeURIComponent(t)];H.isNumber(a)&&s.push("expires="+new Date(a).toGMTString()),H.isString(n)&&s.push("path="+n),H.isString(o)&&s.push("domain="+o),!0===r&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ae(e,t,a){let n=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(n||0==a)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const De=e=>e instanceof Ne?{...e}:e;function Fe(e,t){t=t||{};const a={};function n(e,t,a,n){return H.isPlainObject(e)&&H.isPlainObject(t)?H.merge.call({caseless:n},e,t):H.isPlainObject(t)?H.merge({},t):H.isArray(t)?t.slice():t}function o(e,t,a,o){return H.isUndefined(t)?H.isUndefined(e)?void 0:n(void 0,e,0,o):n(e,t,0,o)}function r(e,t){if(!H.isUndefined(t))return n(void 0,t)}function s(e,t){return H.isUndefined(t)?H.isUndefined(e)?void 0:n(void 0,e):n(void 0,t)}function i(a,o,r){return r in t?n(a,o):r in e?n(void 0,a):void 0}const l={url:r,method:r,data:r,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:i,headers:(e,t,a)=>o(De(e),De(t),0,!0)};return H.forEach(Object.keys(Object.assign({},e,t)),(function(n){const r=l[n]||o,s=r(e[n],t[n],n);H.isUndefined(s)&&r!==i||(a[n]=s)})),a}const _e=e=>{const t=Fe({},e);let a,{data:n,withXSRFToken:o,xsrfHeaderName:r,xsrfCookieName:s,headers:i,auth:l}=t;if(t.headers=i=Ne.from(i),t.url=oe(Ae(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),H.isFormData(n))if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(a=i.getContentType())){const[e,...t]=a?a.split(";").map((e=>e.trim())).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if(pe.hasStandardBrowserEnv&&(o&&H.isFunction(o)&&(o=o(t)),o||!1!==o&&Pe(t.url))){const e=r&&s&&Oe.read(s);e&&i.set(r,e)}return t},$e="undefined"!=typeof XMLHttpRequest&&function(e){return new Promise((function(t,a){const n=_e(e);let o=n.data;const r=Ne.from(n.headers).normalize();let s,i,l,c,d,{responseType:u,onUploadProgress:m,onDownloadProgress:p}=n;function g(){c&&c(),d&&d(),n.cancelToken&&n.cancelToken.unsubscribe(s),n.signal&&n.signal.removeEventListener("abort",s)}let h=new XMLHttpRequest;function f(){if(!h)return;const n=Ne.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders());xe((function(e){t(e),g()}),(function(e){a(e),g()}),{data:u&&"text"!==u&&"json"!==u?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:n,config:e,request:h}),h=null}h.open(n.method.toUpperCase(),n.url,!0),h.timeout=n.timeout,"onloadend"in h?h.onloadend=f:h.onreadystatechange=function(){h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))&&setTimeout(f)},h.onabort=function(){h&&(a(new W("Request aborted",W.ECONNABORTED,e,h)),h=null)},h.onerror=function(){a(new W("Network Error",W.ERR_NETWORK,e,h)),h=null},h.ontimeout=function(){let t=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const o=n.transitional||se;n.timeoutErrorMessage&&(t=n.timeoutErrorMessage),a(new W(t,o.clarifyTimeoutError?W.ETIMEDOUT:W.ECONNABORTED,e,h)),h=null},void 0===o&&r.setContentType(null),"setRequestHeader"in h&&H.forEach(r.toJSON(),(function(e,t){h.setRequestHeader(t,e)})),H.isUndefined(n.withCredentials)||(h.withCredentials=!!n.withCredentials),u&&"json"!==u&&(h.responseType=n.responseType),p&&([l,d]=Te(p,!0),h.addEventListener("progress",l)),m&&h.upload&&([i,c]=Te(m),h.upload.addEventListener("progress",i),h.upload.addEventListener("loadend",c)),(n.cancelToken||n.signal)&&(s=t=>{h&&(a(!t||t.type?new Ce(null,e,h):t),h.abort(),h=null)},n.cancelToken&&n.cancelToken.subscribe(s),n.signal&&(n.signal.aborted?s():n.signal.addEventListener("abort",s)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);v&&-1===pe.protocols.indexOf(v)?a(new W("Unsupported protocol "+v+":",W.ERR_BAD_REQUEST,e)):h.send(o||null)}))},Le=(e,t)=>{const{length:a}=e=e?e.filter(Boolean):[];if(t||a){let a,n=new AbortController;const o=function(e){if(!a){a=!0,s();const t=e instanceof Error?e:this.reason;n.abort(t instanceof W?t:new Ce(t instanceof Error?t.message:t))}};let r=t&&setTimeout((()=>{r=null,o(new W(`timeout ${t} of ms exceeded`,W.ETIMEDOUT))}),t);const s=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach((e=>{e.unsubscribe?e.unsubscribe(o):e.removeEventListener("abort",o)})),e=null)};e.forEach((e=>e.addEventListener("abort",o)));const{signal:i}=n;return i.unsubscribe=()=>H.asap(s),i}},Me=function*(e,t){let a=e.byteLength;if(!t||a<t)return void(yield e);let n,o=0;for(;o<a;)n=o+t,yield e.slice(o,n),o=n},Ie=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:a}=await t.read();if(e)break;yield a}}finally{await t.cancel()}},Ue=(e,t,a,n)=>{const o=async function*(e,t){for await(const a of Ie(e))yield*Me(a,t)}(e,t);let r,s=0,i=e=>{r||(r=!0,n&&n(e))};return new ReadableStream({async pull(e){try{const{done:t,value:n}=await o.next();if(t)return i(),void e.close();let r=n.byteLength;if(a){let e=s+=r;a(e)}e.enqueue(new Uint8Array(n))}catch(t){throw i(t),t}},cancel:e=>(i(e),o.return())},{highWaterMark:2})},je="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,ze=je&&"function"==typeof ReadableStream,qe=je&&("function"==typeof TextEncoder?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),He=(e,...t)=>{try{return!!e(...t)}catch(a){return!1}},We=ze&&He((()=>{let e=!1;const t=new Request(pe.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})),Ye=ze&&He((()=>H.isReadableStream(new Response("").body))),Je={stream:Ye&&(e=>e.body)};var Xe;je&&(Xe=new Response,["text","arrayBuffer","blob","formData","stream"].forEach((e=>{!Je[e]&&(Je[e]=H.isFunction(Xe[e])?t=>t[e]():(t,a)=>{throw new W(`Response type '${e}' is not supported`,W.ERR_NOT_SUPPORT,a)})})));const Ke=async(e,t)=>{const a=H.toFiniteNumber(e.getContentLength());return null==a?(async e=>{if(null==e)return 0;if(H.isBlob(e))return e.size;if(H.isSpecCompliantForm(e)){const t=new Request(pe.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return H.isArrayBufferView(e)||H.isArrayBuffer(e)?e.byteLength:(H.isURLSearchParams(e)&&(e+=""),H.isString(e)?(await qe(e)).byteLength:void 0)})(t):a},Ge={http:null,xhr:$e,fetch:je&&(async e=>{let{url:t,method:a,data:n,signal:o,cancelToken:r,timeout:s,onDownloadProgress:i,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:m}=_e(e);c=c?(c+"").toLowerCase():"text";let p,g=Le([o,r&&r.toAbortSignal()],s);const h=g&&g.unsubscribe&&(()=>{g.unsubscribe()});let f;try{if(l&&We&&"get"!==a&&"head"!==a&&0!==(f=await Ke(d,n))){let e,a=new Request(t,{method:"POST",body:n,duplex:"half"});if(H.isFormData(n)&&(e=a.headers.get("content-type"))&&d.setContentType(e),a.body){const[e,t]=Be(f,Te(Re(l)));n=Ue(a.body,65536,e,t)}}H.isString(u)||(u=u?"include":"omit");const o="credentials"in Request.prototype;p=new Request(t,{...m,signal:g,method:a.toUpperCase(),headers:d.normalize().toJSON(),body:n,duplex:"half",credentials:o?u:void 0});let r=await fetch(p);const s=Ye&&("stream"===c||"response"===c);if(Ye&&(i||s&&h)){const e={};["status","statusText","headers"].forEach((t=>{e[t]=r[t]}));const t=H.toFiniteNumber(r.headers.get("content-length")),[a,n]=i&&Be(t,Te(Re(i),!0))||[];r=new Response(Ue(r.body,65536,a,(()=>{n&&n(),h&&h()})),e)}c=c||"text";let v=await Je[H.findKey(Je,c)||"text"](r,e);return!s&&h&&h(),await new Promise(((t,a)=>{xe(t,a,{data:v,headers:Ne.from(r.headers),status:r.status,statusText:r.statusText,config:e,request:p})}))}catch(v){if(h&&h(),v&&"TypeError"===v.name&&/fetch/i.test(v.message))throw Object.assign(new W("Network Error",W.ERR_NETWORK,e,p),{cause:v.cause||v});throw W.from(v,v&&v.code,e,p)}})};H.forEach(Ge,((e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(a){}Object.defineProperty(e,"adapterName",{value:t})}}));const Ze=e=>`- ${e}`,Qe=e=>H.isFunction(e)||null===e||!1===e,et=e=>{e=H.isArray(e)?e:[e];const{length:t}=e;let a,n;const o={};for(let r=0;r<t;r++){let t;if(a=e[r],n=a,!Qe(a)&&(n=Ge[(t=String(a)).toLowerCase()],void 0===n))throw new W(`Unknown adapter '${t}'`);if(n)break;o[t||"#"+r]=n}if(!n){const e=Object.entries(o).map((([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")));throw new W("There is no suitable adapter to dispatch the request "+(t?e.length>1?"since :\n"+e.map(Ze).join("\n"):" "+Ze(e[0]):"as no adapter specified"),"ERR_NOT_SUPPORT")}return n};function tt(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ce(null,e)}function at(e){tt(e),e.headers=Ne.from(e.headers),e.data=Se.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return et(e.adapter||fe.adapter)(e).then((function(t){return tt(e),t.data=Se.call(e,e.transformResponse,t),t.headers=Ne.from(t.headers),t}),(function(t){return Ve(t)||(tt(e),t&&t.response&&(t.response.data=Se.call(e,e.transformResponse,t.response),t.response.headers=Ne.from(t.response.headers))),Promise.reject(t)}))}const nt="1.8.4",ot={};["object","boolean","number","function","string","symbol"].forEach(((e,t)=>{ot[e]=function(a){return typeof a===e||"a"+(t<1?"n ":" ")+e}}));const rt={};ot.transitional=function(e,a,n){function o(e,t){return"[Axios v1.8.4] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,s)=>{if(!1===e)throw new W(o(r," has been removed"+(a?" in "+a:"")),W.ERR_DEPRECATED);return a&&!rt[r]&&(rt[r]=!0,t("warn","at node_modules/axios/lib/helpers/validator.js:43",o(r," has been deprecated since v"+a+" and will be removed in the near future"))),!e||e(n,r,s)}},ot.spelling=function(e){return(a,n)=>(t("warn","at node_modules/axios/lib/helpers/validator.js:58",`${n} is likely a misspelling of ${e}`),!0)};const st={assertOptions:function(e,t,a){if("object"!=typeof e)throw new W("options must be an object",W.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let o=n.length;for(;o-- >0;){const r=n[o],s=t[r];if(s){const t=e[r],a=void 0===t||s(t,r,e);if(!0!==a)throw new W("option "+r+" must be "+a,W.ERR_BAD_OPTION_VALUE)}else if(!0!==a)throw new W("Unknown option "+r,W.ERR_BAD_OPTION)}},validators:ot},it=st.validators;class lt{constructor(e){this.defaults=e,this.interceptors={request:new re,response:new re}}async request(e,t){try{return await this._request(e,t)}catch(a){if(a instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{a.stack?t&&!String(a.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(a.stack+="\n"+t):a.stack=t}catch(n){}}throw a}}_request(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},t=Fe(this.defaults,t);const{transitional:a,paramsSerializer:n,headers:o}=t;void 0!==a&&st.assertOptions(a,{silentJSONParsing:it.transitional(it.boolean),forcedJSONParsing:it.transitional(it.boolean),clarifyTimeoutError:it.transitional(it.boolean)},!1),null!=n&&(H.isFunction(n)?t.paramsSerializer={serialize:n}:st.assertOptions(n,{encode:it.function,serialize:it.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),st.assertOptions(t,{baseUrl:it.spelling("baseURL"),withXsrfToken:it.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=o&&H.merge(o.common,o[t.method]);o&&H.forEach(["delete","get","head","post","put","patch","common"],(e=>{delete o[e]})),t.headers=Ne.concat(r,o);const s=[];let i=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));const l=[];let c;this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));let d,u=0;if(!i){const e=[at.bind(this),void 0];for(e.unshift.apply(e,s),e.push.apply(e,l),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=s.length;let m=t;for(u=0;u<d;){const e=s[u++],t=s[u++];try{m=e(m)}catch(p){t.call(this,p);break}}try{c=at.call(this,m)}catch(p){return Promise.reject(p)}for(u=0,d=l.length;u<d;)c=c.then(l[u++],l[u++]);return c}getUri(e){return oe(Ae((e=Fe(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}H.forEach(["delete","get","head","options"],(function(e){lt.prototype[e]=function(t,a){return this.request(Fe(a||{},{method:e,url:t,data:(a||{}).data}))}})),H.forEach(["post","put","patch"],(function(e){function t(t){return function(a,n,o){return this.request(Fe(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:a,data:n}))}}lt.prototype[e]=t(),lt.prototype[e+"Form"]=t(!0)}));const ct=lt;class dt{constructor(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise((function(e){t=e}));const a=this;this.promise.then((e=>{if(!a._listeners)return;let t=a._listeners.length;for(;t-- >0;)a._listeners[t](e);a._listeners=null})),this.promise.then=e=>{let t;const n=new Promise((e=>{a.subscribe(e),t=e})).then(e);return n.cancel=function(){a.unsubscribe(t)},n},e((function(e,n,o){a.reason||(a.reason=new Ce(e,n,o),t(a.reason))}))}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new dt((function(t){e=t})),cancel:e}}}const ut=dt;const mt={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(mt).forEach((([e,t])=>{mt[t]=e}));const pt=mt;const gt=function e(t){const a=new ct(t),n=s(ct.prototype.request,a);return H.extend(n,ct.prototype,a,{allOwnKeys:!0}),H.extend(n,a,null,{allOwnKeys:!0}),n.create=function(a){return e(Fe(t,a))},n}(fe);gt.Axios=ct,gt.CanceledError=Ce,gt.CancelToken=ut,gt.isCancel=Ve,gt.VERSION=nt,gt.toFormData=Q,gt.AxiosError=W,gt.Cancel=gt.CanceledError,gt.all=function(e){return Promise.all(e)},gt.spread=function(e){return function(t){return e.apply(null,t)}},gt.isAxiosError=function(e){return H.isObject(e)&&!0===e.isAxiosError},gt.mergeConfig=Fe,gt.AxiosHeaders=Ne,gt.formToJSON=e=>ge(H.isHTMLForm(e)?new FormData(e):e),gt.getAdapter=et,gt.HttpStatusCode=pt,gt.default=gt;const ht="http://8.155.35.219:8088",ft={__name:"index",setup(a){const n=e.ref({latitude:30.65742,longitude:104.06584,markers:[{id:1,latitude:30.6586,longitude:104.0757,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Current Location",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:2,latitude:30.6678,longitude:104.0873,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Chunxi Road Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:3,latitude:30.7048,longitude:104.0731,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Shuangshui Street Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:4,latitude:30.6383,longitude:104.0526,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Yulin Street Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}}]});let r=!1;const s=e.ref([{shopName:"Chunxi Road Station",locationName:"Chunxi Road Station",distance:"1.3",scooterName:"Long-range Commuting-Battery Swap",image:"/static/images/car1.jpeg",price:"249",tags:["Unlimited Battery Swap","Transparent Price","Credit-Free"],latitude:30.6586,longitude:104.0757},{shopName:"Academy Street Station",locationName:"Academy Street Station",distance:"1.5",scooterName:"Long-range Commuting-Battery Swap",image:"/static/images/car2.jpg",price:"249",tags:["Unlimited Battery Swap","Transparent Price","Credit-Free"],latitude:30.6678,longitude:104.0873},{shopName:"Shuangshui Street Station",locationName:"Shuangshui Street Station",distance:"2.0",scooterName:"Long-range Commuting-Battery Swap",image:"/static/images/car1.jpeg",price:"249",tags:["Unlimited Battery Swap","Transparent Price","Credit-Free"],latitude:30.7048,longitude:104.0731},{shopName:"Yulin Street Station",locationName:"Yulin Street Station",distance:"1.8",scooterName:"Long-range Commuting-Battery Swap",image:"/static/images/car2.jpg",price:"249",tags:["Unlimited Battery Swap","Transparent Price","Credit-Free"],latitude:30.6383,longitude:104.0526}]),i=e.ref(!1),l=async()=>{var e;if(!r){r=!0;try{const t=await uni.request({url:"https://restapi.amap.com/v3/ip",data:{key:"ca477bb891ebf75dc880f2688b9cf324",output:"json"}});if("1"===t.data.status&&t.data.city){const a=await uni.request({url:"https://restapi.amap.com/v3/geocode/geo",data:{key:"ca477bb891ebf75dc880f2688b9cf324",address:t.data.city,output:"json"}});if("1"===a.data.status&&(null==(e=a.data.geocodes)?void 0:e.length)>0){const e=a.data.geocodes[0].location.split(","),t=parseFloat(e[0]),o=parseFloat(e[1]);n.value={latitude:o,longitude:t,markers:[{id:0,latitude:o,longitude:t,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Current Location",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:1,latitude:30.6586,longitude:104.0757,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Chunxi Road Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:2,latitude:30.6678,longitude:104.0873,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Academy Street Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:3,latitude:30.7048,longitude:104.0731,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Shuangshui Street Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}},{id:4,latitude:30.6383,longitude:104.0526,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:"Yulin Street Station",color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}}]}}}}catch(a){t("error","at pages/index/index.vue:365","位置获取失败：",a),uni.showToast({title:"Using default location (Chengdu)",icon:"none",duration:2e3})}finally{r=!1}}},c=async()=>{try{const e=await gt.get(`${ht}/admin/stationAndScooter`);if(200!==e.data.statusCode)throw new Error("获取数据失败");{const t=e.data.data,a=t.map(((e,t)=>({id:t+1,latitude:e.station.latitude,longitude:e.station.longitude,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:e.station.name,color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}})));n.value.markers=[n.value.markers[0],...a],s.value=t.map((e=>{const t=e.scooters.filter((e=>0===e.status)).length;return{shopName:e.station.name,locationName:e.station.name,distance:d(n.value.latitude,n.value.longitude,e.station.latitude,e.station.longitude).toFixed(1),scooterName:"Long-range Commuting-Battery Swap",image:"/static/images/car1.jpeg",price:"249",tags:[`Available Vehicles: ${t}`,"Unlimited Battery Swap","Transparent Price","Credit-Free"],latitude:e.station.latitude,longitude:e.station.longitude,scooters:e.scooters}}))}}catch(e){t("error","at pages/index/index.vue:441","获取站点和电动车数据失败：",e),uni.showToast({title:"Failed to get data, using default data",icon:"none"})}},d=(e,t,a,n)=>{const o=(a-e)*Math.PI/180,r=(n-t)*Math.PI/180,s=Math.sin(o/2)*Math.sin(o/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 6371*(2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)))};e.onMounted((()=>{(async()=>{try{await l()}catch(e){t("error","at pages/index/index.vue:468","地图初始化失败：",e),uni.showToast({title:"Map initialization failed, please try again",icon:"none"})}})(),c()})),o((()=>{r||(l(),c())}));const u=()=>{uni.switchTab({url:"/pages/user/user"})};return(a,o)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:e.normalizeClass(["header",{dark:i.value}])},[e.createElementVNode("view",{class:"header-center"},[e.createElementVNode("text",{class:"title"},"Rongcheng Travel"),e.createElementVNode("text",{class:"sub"},"Safe Rental")])],2),e.createElementVNode("view",{class:"map-container"},[e.createElementVNode("map",{id:"map",class:"map",latitude:n.value.latitude,longitude:n.value.longitude,markers:n.value.markers,scale:16,"show-location":""},null,8,["latitude","longitude","markers"])]),e.createElementVNode("view",{class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(a=>(e.openBlock(),e.createElementBlock("view",{class:"item",key:a.shopName+a.locationName},[e.createElementVNode("view",{class:"item-header"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("text",{class:"shop"},"【"+e.toDisplayString(a.shopName)+"】",1),e.createElementVNode("text",{class:"addr"},e.toDisplayString(a.locationName),1)]),e.createElementVNode("text",{class:"dist"},e.toDisplayString(a.distance)+"km",1)]),e.createElementVNode("view",{class:"item-body"},[e.createElementVNode("view",{class:"info"},[e.createElementVNode("image",{src:a.image,mode:"aspectFit",class:"pic"},null,8,["src"]),e.createElementVNode("view",{class:"detail"},[e.createElementVNode("text",{class:"name"},e.toDisplayString(a.scooterName),1),e.createElementVNode("view",{class:"tags"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.tags,(t=>(e.openBlock(),e.createElementBlock("text",{class:"tag",key:t},e.toDisplayString(t),1)))),128))])])]),e.createElementVNode("view",{class:"price-box"},[e.createElementVNode("text",{class:"price"},"Month Rent ¥30"),e.createElementVNode("button",{class:"btn",onClick:e=>(e=>{try{const t=s.value.find((t=>t.shopName===e.shopName));if(!t)throw new Error("未找到站点数据");const a=encodeURIComponent(JSON.stringify({shopName:e.shopName,locationName:e.locationName,scooterName:e.scooterName,price:e.price,image:e.image,scooters:t.scooters||[]}));uni.navigateTo({url:`/pages/rent/rent?data=${a}`})}catch(a){t("error","at pages/index/index.vue:235","跳转租赁页面失败:",a),uni.showToast({title:"跳转失败，请重试",icon:"none"})}})(a)},"Rental",8,["onClick"])])])])))),128))]),e.createElementVNode("view",{class:"tab-bar"},[e.createElementVNode("view",{class:"tab-item"},[e.createElementVNode("view",{class:"icon"},[e.createElementVNode("text",{class:"iconfont icon-home"})]),e.createElementVNode("text",null,"Rental")]),e.createElementVNode("view",{class:"tab-item",onClick:u},[e.createElementVNode("view",{class:"icon"},[e.createElementVNode("text",{class:"iconfont icon-user"})]),e.createElementVNode("text",null,"My")])])]))}},vt="/static/images/husky-avatar.png",yt={__name:"login",setup(a){const n=e.ref("1550320492@qq.com"),o=e.ref("123456"),r=e.ref(!1),s=e.ref(!1),i=e.ref(""),l=e.ref(""),c=e.computed((()=>n.value&&o.value.length>=6&&s.value)),d=()=>{r.value=!r.value},u=e=>{s.value=e.detail.value.length>0},m=()=>{uni.navigateBack()},p=async()=>{if(c.value)if(n.value&&o.value)try{const e=await gt.post(`${ht}/user/login`,{email:n.value,password:o.value,role:"user"});if(t("log","at pages/login/login.vue:148",e),200===e.data.statusCode){const t={id:e.data.data.user.id,name:e.data.data.user.name,email:e.data.data.user.email,card:e.data.data.user.card,createTime:e.data.data.user.createTime,discount:e.data.data.user.discount,role:e.data.data.user.role};uni.setStorageSync("userInfo",JSON.stringify(t)),uni.setStorageSync("token",e.data.data.token),g("Login successful","success"),setTimeout((()=>{uni.switchTab({url:"/pages/index/index"})}),1e3)}else g("Incorrect email or password","error")}catch(e){t("error","at pages/login/login.vue:178","Login failed:",e),g("Network error, please try again","error")}else g("Please enter email and password","error")},g=(e,t)=>{i.value=e,l.value=t},h=()=>{uni.navigateTo({url:"/pages/register/register"})},f=()=>{uni.navigateTo({url:"/pages/privacy/privacy"})},v=()=>{uni.navigateTo({url:"/pages/login-help/login-help"})},y=e=>{uni.showToast({title:`${e} Login`,icon:"none"})},w=async()=>{try{const e=`Guest_${Math.floor(1e4*Math.random())}`,t=`${e.toLowerCase()}@guest.com`,a="123456";if(200===(await gt.post(`${ht}/user`,{name:e,email:t,password:a,role:"user"})).data.statusCode){const e=await gt.post(`${ht}/user/login`,{email:t,password:a,role:"user"});if(200===e.data.statusCode){const t={id:e.data.data.user.id,name:e.data.data.user.name,email:e.data.data.user.email,card:e.data.data.user.card,createTime:e.data.data.user.createTime,discount:e.data.data.user.discount,role:e.data.data.user.role};uni.setStorageSync("userInfo",JSON.stringify(t)),uni.setStorageSync("token",e.data.data.token),g("Login successful","success"),setTimeout((()=>{uni.switchTab({url:"/pages/index/index"})}),1e3)}}}catch(e){t("error","at pages/login/login.vue:264","Guest login failed:",e),g("Guest login failed, please try again","error")}};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"login-container"},[e.createElementVNode("view",{class:"status-bar"},[e.createElementVNode("view",{class:"center"},[e.createElementVNode("text",{class:"center-text"},"Rongcheng Travel")])]),e.createElementVNode("view",{class:"back-btn",onClick:m},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("image",{class:"avatar",src:vt,mode:"aspectFill"}),e.createElementVNode("text",{class:"title"},"Account Login")]),e.createElementVNode("view",{class:"login-form"},[i.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["message",l.value])},e.toDisplayString(i.value),3)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"Please enter email",class:"input-item"},null,512),[[e.vModelText,n.value]])]),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:r.value?"text":"password","onUpdate:modelValue":a[1]||(a[1]=e=>o.value=e),placeholder:"Please enter password",class:"input-item"},null,8,["type"]),[[e.vModelDynamic,o.value]]),e.createElementVNode("text",{class:"toggle-password",onClick:d},e.toDisplayString(r.value?"Hide":"Show"),1)]),e.createElementVNode("view",{class:"privacy-policy"},[e.createElementVNode("checkbox-group",{onChange:u},[e.createElementVNode("checkbox",{checked:s.value,color:"#1890ff"},null,8,["checked"])],32),e.createElementVNode("text",{class:"policy-text"},"I have read the"),e.createElementVNode("text",{class:"policy-link",onClick:f},"Legal and Privacy Policy")]),e.createElementVNode("button",{class:e.normalizeClass(["login-btn",{"login-btn-active":c.value}]),disabled:!c.value,onClick:p},"Login",10,["disabled"]),e.createElementVNode("button",{class:"guest-login-btn",onClick:w},"Login as Guest"),e.createElementVNode("button",{class:"register-btn",onClick:h},"Create Account"),e.createElementVNode("view",{class:"login-help"},[e.createElementVNode("text",{onClick:v},"Having trouble logging in?")]),e.createElementVNode("view",{class:"other-login"},[e.createElementVNode("text",{class:"other-title"},"Other Login Methods"),e.createElementVNode("view",{class:"login-methods"},[e.createElementVNode("view",{class:"method-item",onClick:a[2]||(a[2]=e=>y("alipay"))},[e.createElementVNode("image",{src:"/static/icons/alipay.png",mode:"aspectFit"})]),e.createElementVNode("view",{class:"method-item",onClick:a[3]||(a[3]=e=>y("apple"))},[e.createElementVNode("image",{src:"/static/icons/apple.png",mode:"aspectFit"})])])])])]))}},wt={__name:"register",setup(a){const n=e.ref(""),r=e.ref(""),s=e.ref(""),i=e.ref(""),l=e.ref(!1),c=e.ref(!1),d=e.ref(!1),u=e.ref(""),m=e.ref(""),p=e.ref(!1),g=e.ref(!1);o((()=>{h()})),e.onMounted((()=>{h()}));const h=()=>{p.value=!1,setTimeout((()=>{p.value=!0,f()}),50)},f=()=>{n.value="",r.value="",s.value="",i.value="",l.value=!1,c.value=!1,d.value=!1,u.value="",m.value="",g.value=!1},v=e.computed((()=>n.value&&r.value&&s.value&&i.value&&s.value===i.value&&s.value.length>=6&&d.value)),y=()=>{l.value=!l.value},w=()=>{c.value=!c.value},E=e=>{d.value=e.detail.value.length>0},b=()=>{uni.navigateTo({url:"/pages/login/login"})},k=async()=>{var e,a;if(g.value)return;if(g.value=!0,!v.value)return N("Please fill in all required fields","error"),void(g.value=!1);if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value))return N("Please enter a valid email address","error"),void(g.value=!1);if(s.value!==i.value)return N("Passwords do not match","error"),void(g.value=!1);try{t("log","at pages/register/register.vue:208","Sending registration request...");const a=await gt.post(`${ht}/user`,{name:n.value,email:r.value,password:s.value,role:"user"});if(t("log","at pages/register/register.vue:216","Registration response:",a),a.data&&200===a.data.statusCode)N("Registration successful","success"),setTimeout((()=>{uni.navigateTo({url:"/pages/login/login"})}),1500);else{const t=(null==(e=a.data)?void 0:e.message)||"Registration failed, please try again";N(t,"error")}}catch(o){if(t("error","at pages/register/register.vue:230","Registration failed:",o),o.response){const e=(null==(a=o.response.data)?void 0:a.message)||"Registration failed, please try again";N(e,"error")}else o.request?N("Network error, please check your connection","error"):N("An unexpected error occurred","error")}finally{g.value=!1}},N=(e,t)=>{u.value=e,m.value=t},S=()=>{uni.navigateTo({url:"/pages/login/login"})},V=()=>{uni.navigateTo({url:"/pages/privacy/privacy"})};return(t,a)=>p.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"register-container"},[e.createElementVNode("view",{class:"status-bar"},[e.createElementVNode("view",{class:"center"},[e.createElementVNode("text",{class:"center-text"},"Rongcheng Travel")])]),e.createElementVNode("view",{class:"back-btn",onClick:b},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("view",{class:"user-info"},[e.createElementVNode("image",{class:"avatar",src:vt,mode:"aspectFill"}),e.createElementVNode("text",{class:"title"},"Create Account")]),e.createElementVNode("view",{class:"register-form"},[u.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["message",m.value])},e.toDisplayString(u.value),3)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"Please enter username",class:"input-item",focus:!0},null,512),[[e.vModelText,n.value]])]),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>r.value=e),placeholder:"Please enter email",class:"input-item"},null,512),[[e.vModelText,r.value]])]),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:l.value?"text":"password","onUpdate:modelValue":a[2]||(a[2]=e=>s.value=e),placeholder:"Please enter password",class:"input-item"},null,8,["type"]),[[e.vModelDynamic,s.value]]),e.createElementVNode("text",{class:"toggle-password",onClick:y},e.toDisplayString(l.value?"Hide":"Show"),1)]),e.createElementVNode("view",{class:"input-group"},[e.withDirectives(e.createElementVNode("input",{type:c.value?"text":"password","onUpdate:modelValue":a[3]||(a[3]=e=>i.value=e),placeholder:"Please confirm password",class:"input-item"},null,8,["type"]),[[e.vModelDynamic,i.value]]),e.createElementVNode("text",{class:"toggle-password",onClick:w},e.toDisplayString(c.value?"Hide":"Show"),1)]),e.createElementVNode("view",{class:"privacy-policy"},[e.createElementVNode("checkbox-group",{onChange:E},[e.createElementVNode("checkbox",{checked:d.value,color:"#1890ff"},null,8,["checked"])],32),e.createElementVNode("text",{class:"policy-text"},"I have read and agree to the"),e.createElementVNode("text",{class:"policy-link",onClick:V},"Legal Terms and Privacy Policy")]),e.createElementVNode("button",{class:e.normalizeClass(["register-btn",{"register-btn-active":v.value}]),disabled:!v.value||g.value,onClick:k},e.toDisplayString(g.value?"Registering...":"Register"),11,["disabled"]),e.createElementVNode("button",{class:"login-btn",onClick:S},"Back to Login")])])):e.createCommentVNode("",!0)}},Et="/static/icons/card.png",bt={__name:"user",setup(a){const n=e.ref(null),r=e.computed((()=>!!n.value)),s=e.ref({totalDistance:0,totalRides:0,cardMiles:0,carbonSaved:0});e.onMounted((()=>{i()})),o((()=>{n.value=null,i()}));const i=()=>{try{const e=uni.getStorageSync("userInfo");e&&(n.value=JSON.parse(e),l())}catch(e){t("error","at pages/user/user.vue:171","获取用户信息失败:",e)}},l=()=>{s.value={totalDistance:0,totalRides:0,cardMiles:0,carbonSaved:0}},c=()=>{uni.navigateTo({url:"/pages/login/login"})},d=()=>{if(!r.value)return c();uni.navigateTo({url:"/pages/setting/setting"})},u=e=>{if(!r.value)return c();uni.navigateTo({url:`/pages/order/order?type=${e}`})},m=()=>{if(!r.value)return c();uni.navigateTo({url:"/pages/card/card"})},p=()=>{uni.showModal({title:"Confirm",content:"Are you sure you want to logout?",confirmText:"Confirm",cancelText:"Cancel",success:e=>{e.confirm&&(uni.removeStorageSync("userInfo"),n.value=null,uni.showToast({title:"Logged out successfully",icon:"success"}))}})},g=()=>{if(!r.value)return c();uni.navigateTo({url:"/pages/feedback/list"})};return(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"user-header"},[r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"user-info"},[e.createElementVNode("image",{class:"avatar",src:n.value.avatar||"/static/images/husky-avatar.png",mode:"aspectFill"},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("text",{class:"name"},e.toDisplayString(n.value.name||n.value.email.split("@")[0]),1)])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"user-info",onClick:c},[e.createElementVNode("image",{class:"avatar",src:vt,mode:"aspectFill"}),e.createElementVNode("view",{class:"info"},[e.createElementVNode("text",{class:"login-text"},"Click to Login/Register")])])),e.createElementVNode("view",{class:"header-btns"},[e.createElementVNode("view",{class:"btn-item",onClick:d},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/setting.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"Settings")])])]),e.createElementVNode("view",{class:"order-card"},[e.createElementVNode("view",{class:"order-types"},[e.createElementVNode("view",{class:"type-item",onClick:a[0]||(a[0]=e=>u("all"))},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/order-all.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"All")]),e.createElementVNode("view",{class:"type-item",onClick:a[1]||(a[1]=e=>u("unpaid"))},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/order-unpaid.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"Unpaid")]),e.createElementVNode("view",{class:"type-item",onClick:a[2]||(a[2]=e=>u("notstarted"))},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/notstart.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"Panding")]),e.createElementVNode("view",{class:"type-item",onClick:a[3]||(a[3]=e=>u("ongoing"))},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/order-ongoing.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"Ongoing")]),e.createElementVNode("view",{class:"type-item",onClick:a[4]||(a[4]=e=>u("completed"))},[e.createElementVNode("view",{class:"icon-wrapper"},[e.createElementVNode("image",{src:"/static/icons/order-completed.png",mode:"aspectFit",class:"icon-img"})]),e.createElementVNode("text",null,"Completed")])])]),e.createElementVNode("view",{class:"card-section"},[e.createElementVNode("view",{class:"card-item",onClick:m},[e.createElementVNode("view",{class:"card-left"},[e.createElementVNode("image",{src:Et,mode:"aspectFit",class:"card-icon"}),e.createElementVNode("text",{class:"card-title"},"My Bank Card")]),e.createElementVNode("view",{class:"card-right"},[e.createElementVNode("text",{class:"card-desc"},"Manage Payment Methods"),e.createElementVNode("text",{class:"iconfont icon-right"},">")])])]),e.createElementVNode("view",{class:"menu-list"},[e.createElementVNode("view",{class:"menu-item",onClick:g},[e.createElementVNode("text",{class:"menu-text"},"My Feedback"),e.createElementVNode("text",{class:"arrow"},">")])]),r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"logout-section"},[e.createElementVNode("button",{class:"logout-btn",onClick:p},"Logout")])):e.createCommentVNode("",!0)]))}};class kt{constructor(e,t){this.options=e,this.animation=uni.createAnimation({...e}),this.currentStepAnimates={},this.next=0,this.$=t}_nvuePushAnimates(e,t){let a=this.currentStepAnimates[this.next],n={};if(n=a||{styles:{},config:{}},Nt.includes(e)){n.styles.transform||(n.styles.transform="");let a="";"rotate"===e&&(a="deg"),n.styles.transform+=`${e}(${t+a}) `}else n.styles[e]=`${t}`;this.currentStepAnimates[this.next]=n}_animateRun(e={},t={}){let a=this.$.$refs.ani.ref;if(a)return new Promise(((n,o)=>{nvueAnimation.transition(a,{styles:e,...t},(e=>{n()}))}))}_nvueNextAnimate(e,t=0,a){let n=e[t];if(n){let{styles:o,config:r}=n;this._animateRun(o,r).then((()=>{t+=1,this._nvueNextAnimate(e,t,a)}))}else this.currentStepAnimates={},"function"==typeof a&&a(),this.isEnd=!0}step(e={}){return this.animation.step(e),this}run(e){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof e&&e()}),this.$.durationTime)}}const Nt=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function St(e,t){if(t)return clearTimeout(t.timer),new kt(e,t)}Nt.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((e=>{kt.prototype[e]=function(...t){return this.animation[e](...t),this}}));const Vt=(e,t)=>{const a=e.__vccOpts||e;for(const[n,o]of t)a[n]=o;return a};const Ct=Vt({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(e){e?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let e={...this.styles,"transition-duration":this.duration/1e3+"s"},t="";for(let a in e){t+=this.toLine(a)+":"+e[a]+";"}return t},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(e={}){e.duration&&(this.durationTime=e.duration),this.animation=St(Object.assign(this.config,e),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(e,a={}){if(this.animation){for(let a in e)try{"object"==typeof e[a]?this.animation[a](...e[a]):this.animation[a](e[a])}catch(n){t("error","at node_modules/@dcloudio/uni-ui/lib/uni-transition/uni-transition.vue:148",`方法 ${a} 不存在`)}return this.animation.step(a),this}},run(e){this.animation&&this.animation.run(e)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:e,transform:t}=this.styleInit(!1);void 0!==e&&(this.opacity=e),this.transform=t,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=St(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(e){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:e,transform:t}=this.styleInit(!1);this.opacity=e||1,this.transform=t,this.$emit("change",{detail:this.isShow})}))},styleInit(e){let t={transform:""},a=(e,a)=>{"fade"===a?t.opacity=this.animationType(e)[a]:t.transform+=this.animationType(e)[a]+" "};return"string"==typeof this.modeClass?a(e,this.modeClass):this.modeClass.forEach((t=>{a(e,t)})),t},tranfromInit(e){let t=(e,t)=>{let a=null;"fade"===t?a=e?0:1:(a=e?"-100%":"0","zoom-in"===t&&(a=e?.8:1),"zoom-out"===t&&(a=e?1.2:1),"slide-right"===t&&(a=e?"100%":"0"),"slide-bottom"===t&&(a=e?"100%":"0")),this.animation[this.animationMode()[t]](a)};return"string"==typeof this.modeClass?t(e,this.modeClass):this.modeClass.forEach((a=>{t(e,a)})),this.animation},animationType:e=>({fade:e?0:1,"slide-top":`translateY(${e?"0":"-100%"})`,"slide-right":`translateX(${e?"0":"100%"})`,"slide-bottom":`translateY(${e?"0":"100%"})`,"slide-left":`translateX(${e?"0":"-100%"})`,"zoom-in":`scaleX(${e?1:.8}) scaleY(${e?1:.8})`,"zoom-out":`scaleX(${e?1:1.2}) scaleY(${e?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:e=>e.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,a,n,o,r,s){return e.withDirectives((e.openBlock(),e.createElementBlock("view",{ref:"ani",animation:r.animationData,class:e.normalizeClass(n.customClass),style:e.normalizeStyle(s.transformStyles),onClick:a[0]||(a[0]=(...e)=>s.onClick&&s.onClick(...e))},[e.renderSlot(t.$slots,"default")],14,["animation"])),[[e.vShow,r.isShow]])}]]),xt={name:"uniPopup",components:{},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"},borderRadius:{type:String}},watch:{type:{handler:function(e){this.config[e]&&this[this.config[e]](!0)},immediate:!0},isDesktop:{handler:function(e){this.config[e]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(e){this.mkclick=e},immediate:!0},isMaskClick:{handler:function(e){this.mkclick=e},immediate:!0},showPopup(e){}},data(){return{duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{backgroundColor:"transparent",borderRadius:this.borderRadius||"0",position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}},computed:{getStyles(){let e={backgroundColor:this.bg};return this.borderRadius,e=Object.assign(e,{borderRadius:this.borderRadius}),e},isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:e,windowHeight:t,windowTop:a,safeArea:n,screenHeight:o,safeAreaInsets:r}=uni.getSystemInfoSync();this.popupWidth=e,this.popupHeight=t+(a||0),n&&this.safeArea?this.safeAreaInsets=r.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},activated(){this.setH5Visible(!this.showPopup)},deactivated(){this.setH5Visible(!0)},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(e=!0){},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(e){e.stopPropagation(),this.clearPropagation=!0},open(e){if(this.showPopup)return;e&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(e)||(e=this.type),this.config[e]?(this[this.config[e]](),this.$emit("change",{show:!0,type:e})):t("error","at node_modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup.vue:310","缺少类型：",e)},close(e){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(e){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.showPoptrans(),this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(e){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg,borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},center(e){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center",borderRadius:this.borderRadius||"0"},e||this.showPoptrans()},left(e){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},right(e){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,borderRadius:this.borderRadius||"0",display:"flex",flexDirection:"column"},e||this.showPoptrans()},showPoptrans(){this.$nextTick((()=>{this.showPopup=!0,this.showTrans=!0}))}}};const Tt=Vt(xt,[["render",function(t,n,o,r,s,i){const l=a(e.resolveDynamicComponent("uni-transition"),Ct);return s.showPopup?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["uni-popup",[s.popupstyle,i.isDesktop?"fixforpc-z-index":""]])},[e.createElementVNode("view",{onTouchstart:n[1]||(n[1]=(...e)=>i.touchstart&&i.touchstart(...e))},[s.maskShow?(e.openBlock(),e.createBlock(l,{key:"1",name:"mask","mode-class":"fade",styles:s.maskClass,duration:s.duration,show:s.showTrans,onClick:i.onTap},null,8,["styles","duration","show","onClick"])):e.createCommentVNode("",!0),e.createVNode(l,{key:"2","mode-class":s.ani,name:"content",styles:s.transClass,duration:s.duration,show:s.showTrans,onClick:i.onTap},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(["uni-popup__wrapper",[s.popupstyle]]),style:e.normalizeStyle(i.getStyles),onClick:n[0]||(n[0]=(...e)=>i.clear&&i.clear(...e))},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)])),_:3},8,["mode-class","styles","duration","show","onClick"])],32)],2)):e.createCommentVNode("",!0)}],["__scopeId","data-v-d77bc3e8"]]),Bt={__name:"rent",setup(n){const o=e.ref([]),s=e.ref("1 Day"),i=e.ref(1),l=e.ref(!1),c=e.ref(""),d=e.ref(""),u=e.ref(new Date),m=e.ref(1),p=e.ref(null),g=e.ref(null);e.ref(!1);const h=e.ref(0),f=e.ref(0),v=e.ref([]),y=e.ref([]),w=e.ref(null),E=()=>{if(!u.value)return;const e=new Date(u.value),t=o.value.find((e=>e.type===s.value));if(!t)return;e.setHours(e.getHours()+t.hours);const a=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0"),i=String(e.getHours()).padStart(2,"0");d.value=`${n}/${r} ${a} ${i}:00`},b=e.computed((()=>{var e;return(null==(e=p.value)?void 0:e.scooters)?p.value.scooters.filter((e=>0===e.status)):[]})),k=e=>({0:"Available",1:"In Use",2:"Maintenance"}[e]||"Unknown");e.watch(s,(()=>{E()})),e.watch(u,(()=>{E()}));const N=e=>{l.value=e.detail.value.length>0},S=async()=>{if(l.value)if(g.value)if(c.value)try{const e=uni.getStorageSync("userInfo");if(!e)return void uni.showToast({title:"Please login first",icon:"none"});const a=JSON.parse(e),n=o.value.find((e=>e.type===s.value));if(!n)throw new Error("Invalid rental option");const r=V(c.value),i=V(d.value);t("log","at pages/rent/rent.vue:342","提交订单数据:",{userId:a.id,scooterId:g.value.id,hireOptionId:n.id,startTime:r,endTime:i});const l=await gt.post(`${ht}/user/book/add`,{userId:a.id,scooterId:g.value.id,hireOptionId:n.id,startTime:r,endTime:i});if(t("log","at pages/rent/rent.vue:358","订单提交响应:",l),200!==l.data.statusCode)throw new Error(l.data.message||"Failed to place order");uni.showToast({title:"Order placed successfully",icon:"success"}),setTimeout((()=>{uni.navigateTo({url:`/pages/order/detail?id=${l.data.data.id}`})}),1500)}catch(e){t("error","at pages/rent/rent.vue:376","提交订单失败:",e),uni.showToast({title:e.message||"Failed to place order",icon:"none"})}else uni.showToast({title:"Please select pickup time",icon:"none"});else uni.showToast({title:"Please select a scooter",icon:"none"});else uni.showToast({title:"Please agree to the agreement",icon:"none"})},V=e=>{if(!e)return"";try{const a=e.split(" ");if(a.length<3)throw new Error("Invalid time format");const n=a[0],o=a[2],[r,s]=n.split("/").map((e=>parseInt(e))),[i]=o.split(":").map((e=>parseInt(e)));t("log","at pages/rent/rent.vue:401","解析的时间:",{month:r,day:s,hours:i});const l=(new Date).getFullYear(),c=new Date(l,r-1,s,i,0,0,0),d=c.getFullYear(),u=String(c.getMonth()+1).padStart(2,"0"),m=String(c.getDate()).padStart(2,"0"),p=`${d}-${u}-${m} ${String(c.getHours()).padStart(2,"0")}:00:00.605087`;return t("log","at pages/rent/rent.vue:413","格式化后的时间:",p),p}catch(a){throw t("error","at pages/rent/rent.vue:417","时间格式化错误:",a,"原始时间字符串:",e),new Error("Invalid time format")}},C=()=>{(()=>{const e=[],t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],a=new Date;for(let o=0;o<7;o++){const n=new Date(a);n.setDate(a.getDate()+o),e.push({day:`${n.getMonth()+1}/${n.getDate()}`,weekday:t[n.getDay()],date:n})}v.value=e;const n=[];for(let o=9;o<=21;o++)n.push(`${o}:00`);y.value=n})(),w.value.open()},x=()=>{w.value.close()},T=()=>{const e=v.value[h.value].date,a=y.value[f.value],[n]=a.split(":").map(Number);t("log","at pages/rent/rent.vue:477","选择的时间:",{selectedDate:e,selectedTime:a,hours:n}),e.setHours(n,0,0,0),u.value=e;const o=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");c.value=`${o}/${r} ${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]} ${a}`,t("log","at pages/rent/rent.vue:487","设置的取车时间:",c.value),E(),x()},B=()=>{C()},R=()=>{uni.showToast({title:"Return time is automatically calculated",icon:"none"})},P=()=>{uni.navigateTo({url:"/pages/agreement/agreement"})},O=()=>{uni.showModal({title:"Price Details",content:`Base Price: ¥${D.value}\nDelivery Fee: ¥0`,showCancel:!1})},A=()=>{uni.navigateBack()},D=e.computed((()=>{const e=o.value.find((e=>e.type===s.value));return e?e.price:0}));return e.onMounted((()=>{(async()=>{try{const e=await gt.get(`${ht}/admin/hireOption`);200===e.data.statusCode&&(o.value=e.data.data.map((e=>{let t,a;return 24===e.hours?(t="1 Day",a="day"):168===e.hours?(t="1 Week",a="week"):(t=`${e.hours} Hours`,a="hour"),{type:t,price:e.money,unit:a,id:e.id,hours:e.hours}})),o.value.length>0&&(s.value=o.value[0].type,m.value=o.value[0].id))}catch(e){t("error","at pages/rent/rent.vue:213","获取租赁方案失败:",e),uni.showToast({title:e.message||"获取租赁方案失败",icon:"none"})}})();const e=new Date;e.setDate(e.getDate()+1),e.setHours(9,0,0,0),u.value=e;const a=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");c.value=`${a}/${n} ${["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()]} 09:00`,E()})),r((e=>{e.data&&(p.value=JSON.parse(decodeURIComponent(e.data)))})),(t,n)=>{const r=a(e.resolveDynamicComponent("uni-popup"),Tt);return e.openBlock(),e.createElementBlock("view",{class:"rent-container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:A},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"Confirm Order")]),e.createElementVNode("view",{class:"scooter-card"},[e.createElementVNode("view",{class:"scooter-content"},[e.createElementVNode("image",{class:"scooter-image",src:"/static/images/car1.jpeg",mode:"aspectFit"}),e.createElementVNode("view",{class:"scooter-details"},[e.createElementVNode("text",{class:"scooter-name"},"Long-range Commuting-Battery Swap"),e.createElementVNode("view",{class:"features"},[e.createElementVNode("text",{class:"feature-tag"},"With Battery"),e.createElementVNode("text",{class:"feature-tag"},"With Phone Mount")]),e.createElementVNode("view",{class:"free-delivery"},"Free Delivery")])])]),e.createElementVNode("view",{class:"scooter-selector"},[e.createElementVNode("text",{class:"section-title"},"Select Scooter"),e.createElementVNode("scroll-view",{class:"scooter-list","scroll-y":""},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(b.value,(t=>{var a,n;return e.openBlock(),e.createElementBlock("view",{key:t.id,class:e.normalizeClass(["scooter-item",{selected:(null==(a=g.value)?void 0:a.id)===t.id}]),onClick:e=>(e=>{g.value=e})(t)},[e.createElementVNode("view",{class:"scooter-info"},[e.createElementVNode("view",{class:"scooter-header"},[e.createElementVNode("text",{class:"scooter-id"},"ID: "+e.toDisplayString(t.id),1),e.createElementVNode("text",{class:e.normalizeClass(["scooter-status",(n=t.status,{0:"status-available",1:"status-in-use",2:"status-maintenance"}[n]||"")])},e.toDisplayString(k(t.status)),3)]),e.createElementVNode("view",{class:"scooter-detail"},[e.createElementVNode("text",{class:"config"},e.toDisplayString(t.config),1),e.createElementVNode("text",{class:"power"},"Power: "+e.toDisplayString(t.power)+"%",1)])])],10,["onClick"])})),128))])]),e.createElementVNode("view",{class:"rent-options"},[e.createElementVNode("text",{class:"section-title"},"Select Rental Plan"),e.createElementVNode("view",{class:"options-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,(t=>(e.openBlock(),e.createElementBlock("view",{key:t.type,class:e.normalizeClass(["option-item",{selected:s.value===t.type}]),onClick:e=>(e=>{s.value=e.type,i.value=1,E()})(t)},[e.createElementVNode("text",{class:"option-type"},e.toDisplayString(t.type),1),e.createElementVNode("text",{class:"option-price"},"¥"+e.toDisplayString(t.price),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"delivery-info"},[e.createElementVNode("view",{class:"info-item",onClick:B},[e.createElementVNode("text",{class:"label"},"Pickup Time"),e.createElementVNode("view",{class:"value-wrapper"},[e.createElementVNode("text",{class:"value"},e.toDisplayString(c.value),1),e.createElementVNode("text",{class:"hint"},"Order duration starts after pickup"),e.createElementVNode("text",{class:"arrow"},">")])]),e.createElementVNode("view",{class:"info-item",onClick:R},[e.createElementVNode("text",{class:"label"},"Return Time"),e.createElementVNode("view",{class:"value-wrapper"},[e.createElementVNode("text",{class:"value"},e.toDisplayString(d.value),1),e.createElementVNode("text",{class:"arrow"},">")])])]),e.createElementVNode("view",{class:"bottom-bar"},[e.createElementVNode("view",{class:"agreement"},[e.createElementVNode("checkbox-group",{onChange:N},[e.createElementVNode("checkbox",{checked:l.value,color:"#1890ff"},null,8,["checked"])],32),e.createElementVNode("text",{class:"agreement-text"},"I have read and agree to"),e.createElementVNode("text",{class:"agreement-link",onClick:P},"《Scooter Rental Agreement》")]),e.createElementVNode("view",{class:"price-section"},[e.createElementVNode("text",{class:"total-price"},"¥"+e.toDisplayString(D.value),1),e.createElementVNode("text",{class:"price-detail",onClick:O},"Details >")]),e.createElementVNode("button",{class:"submit-btn",disabled:!l.value,onClick:S},"Place Order",8,["disabled"])]),e.createVNode(r,{ref_key:"pickerPopup",ref:w,type:"bottom"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"picker-content"},[e.createElementVNode("view",{class:"picker-header"},[e.createElementVNode("text",{class:"picker-cancel",onClick:x},"Cancel"),e.createElementVNode("text",{class:"picker-title"},"Select Time"),e.createElementVNode("text",{class:"picker-confirm",onClick:T},"Confirm")]),e.createElementVNode("view",{class:"picker-body"},[e.createElementVNode("view",{class:"date-section"},[e.createElementVNode("text",{class:"section-title"},"Date"),e.createElementVNode("view",{class:"date-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(v.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["date-item",{selected:h.value===a}]),onClick:e=>(e=>{h.value=e})(a)},[e.createElementVNode("text",{class:"date-day"},e.toDisplayString(t.day),1),e.createElementVNode("text",{class:"date-weekday"},e.toDisplayString(t.weekday),1)],10,["onClick"])))),128))])]),e.createElementVNode("view",{class:"time-section"},[e.createElementVNode("text",{class:"section-title"},"Time"),e.createElementVNode("view",{class:"time-grid"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(y.value,((t,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(["time-item",{selected:f.value===a}]),onClick:e=>(e=>{f.value=e})(a)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"])))),128))])])])])])),_:1},512)])}}},Rt={__name:"pay",setup(a){const n=e.ref(0),s=e.ref(""),i=e.ref(""),l=e.ref(""),c=e.ref(""),d=e.ref("card"),u=e.ref(null),m=e.ref(1),p=e.ref(null),g=e.ref(!1),h=e.ref(""),f=[["1","2","3"],["4","5","6"],["7","8","9"]],v=e.computed((()=>"card"===d.value&&u.value)),y=e.computed((()=>u.value?`Confirm Payment ¥${n.value}`:"Please bind a bank card")),w=()=>{uni.navigateTo({url:"/pages/card/card"})},E=e=>{if(!e)return"";const t=new Date(e);if(!isNaN(t.getTime())){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}const a=e.split(" ");if(a.length>=2){const[e,t]=a,[n,o,r]=e.split("-"),[s,i]=t.split(":");return`${n}-${o}-${r} ${s}:${i}`}return e},b=(e,t)=>{const a=new Date(e),n=new Date(t)-a,o=Math.floor(n/1e3/60);if(o<60)return`${o} minutes`;return`${Math.floor(o/60)} hours ${o%60} minutes`},k=()=>{h.value="",g.value=!0},N=()=>{h.value="",g.value=!1},S=e=>{h.value.length<6&&(h.value+=e)},V=()=>{h.value.length>0&&(h.value=h.value.slice(0,-1))},C=async()=>{if(p.value)if(6===h.value.length)try{const e=await gt.post(`${ht}/user/book/pay/${p.value.id}`,{password:h.value});if(200!==e.data.statusCode)throw new Error(e.data.message||"Payment failed");uni.showToast({title:"Payment successful",icon:"success"}),N(),uni.$emit("refreshOrderList"),setTimeout((()=>{uni.switchTab({url:"/pages/order/order",success:()=>{uni.$emit("refreshOrderList"),setTimeout((()=>{const e=getCurrentPages()[getCurrentPages().length-1];e&&e.$vm&&e.$vm.refreshPage&&e.$vm.refreshPage()}),100)},fail:()=>{uni.reLaunch({url:"/pages/order/order"})}})}),1500)}catch(e){t("error","at pages/pay/pay.vue:340","Payment failed:",e),uni.showToast({title:e.message||"Payment failed",icon:"none"})}else uni.showToast({title:"Please enter 6-digit password",icon:"none"});else uni.showToast({title:"Incomplete order information",icon:"none"})},x=()=>{uni.navigateBack()};return o((()=>{(()=>{try{const e=uni.getStorageSync("userInfo");if(e){const a=JSON.parse(e);a.card&&(u.value=a.card,t("log","at pages/pay/pay.vue:362","用户银行卡信息已更新:",u.value))}}catch(e){t("error","at pages/pay/pay.vue:366","获取用户信息失败:",e)}})()})),r((e=>{t("log","at pages/pay/pay.vue:376","支付页面加载，参数:",e),e.id?(t("log","at pages/pay/pay.vue:379","有订单ID，开始获取订单详情"),(async e=>{t("log","at pages/pay/pay.vue:176","Start fetching order details, order ID:",e);try{const a=uni.getStorageSync("userInfo");if(t("log","at pages/pay/pay.vue:179","User info string:",a),!a)return void uni.showToast({title:"Please login first",icon:"none"});t("log","at pages/pay/pay.vue:189","Parsed user info:",JSON.parse(a));const o=await gt.get(`${ht}/user/book/id/${e}`);if(t("log","at pages/pay/pay.vue:192","API response:",o.data),200!==o.data.statusCode||!o.data.data)throw new Error("Failed to get order details");if(p.value=o.data.data,t("log","at pages/pay/pay.vue:196","Order details:",p.value),n.value=p.value.totalCost,s.value=b(p.value.startTime,p.value.endTime),i.value=E(p.value.startTime),l.value=E(p.value.endTime),c.value=p.value.scooter.id,t("log","at pages/pay/pay.vue:205","Updated display data:",{amount:n.value,duration:s.value,pickupTime:i.value,returnTime:l.value,scooterId:c.value}),s.value.includes("周"))m.value=4;else if(s.value.includes("天"))m.value=3;else if(s.value.includes("小时")){const e=parseInt(s.value);1===e?m.value=1:4===e&&(m.value=2)}t("log","at pages/pay/pay.vue:226","Set hireOptionId:",m.value)}catch(a){t("error","at pages/pay/pay.vue:231","Failed to get order details:",a),uni.showToast({title:"Failed to get order details",icon:"none"})}})(e.id)):(t("log","at pages/pay/pay.vue:382","没有订单ID，使用传入的参数"),n.value=parseFloat(e.amount),s.value=e.duration,i.value=decodeURIComponent(e.pickupTime),l.value=decodeURIComponent(e.returnTime),c.value=e.scooterId)})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"pay-container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:x},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"Payment")]),e.createElementVNode("view",{class:"order-info"},[e.createElementVNode("view",{class:"amount"},[e.createElementVNode("text",{class:"label"},"Amount"),e.createElementVNode("text",{class:"value"},"¥"+e.toDisplayString(n.value),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"label"},"Duration"),e.createElementVNode("text",{class:"value"},e.toDisplayString(s.value),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"label"},"Pickup Time"),e.createElementVNode("text",{class:"value"},e.toDisplayString(i.value),1)]),e.createElementVNode("view",{class:"detail-item"},[e.createElementVNode("text",{class:"label"},"Return Time"),e.createElementVNode("text",{class:"value"},e.toDisplayString(l.value),1)])]),e.createElementVNode("view",{class:"payment-methods"},[e.createElementVNode("text",{class:"section-title"},"Select Payment Method"),e.createElementVNode("view",{class:"method-list"},[e.createElementVNode("view",{class:e.normalizeClass(["method-item",{selected:"card"===d.value}]),onClick:a[0]||(a[0]=e=>{return t="card",void(d.value=t);var t})},[e.createElementVNode("view",{class:"method-info"},[e.createElementVNode("image",{class:"method-icon",src:Et}),e.createElementVNode("text",{class:"method-name"},"Bank Card")]),u.value&&u.value.cardNumber?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card-info"},[e.createElementVNode("text",{class:"card-number"},"**** **** **** "+e.toDisplayString(u.value.cardNumber.slice(-4)),1),e.createElementVNode("text",{class:"bank-name"},e.toDisplayString(u.value.bankName),1)])):(e.openBlock(),e.createElementBlock("text",{key:1,class:"bind-card",onClick:w},"Bind Card"))],2)])]),e.createElementVNode("view",{class:"bottom-bar"},[e.createElementVNode("button",{class:"pay-btn",disabled:!v.value,onClick:k},e.toDisplayString(y.value),9,["disabled"])]),g.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"modal"},[e.createElementVNode("view",{class:"modal-mask",onClick:N}),e.createElementVNode("view",{class:"password-modal"},[e.createElementVNode("view",{class:"modal-title"},"Enter Payment Password"),e.createElementVNode("view",{class:"password-input"},[e.createElementVNode("view",{class:"password-dots"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(6,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["dot",{filled:h.value.length>a}])},null,2))),64))])]),e.createElementVNode("view",{class:"keyboard"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(f,((t,a)=>e.createElementVNode("view",{class:"keyboard-row",key:a},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"key",key:a,onClick:e=>S(t)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],8,["onClick"])))),128))]))),64)),e.createElementVNode("view",{class:"keyboard-row"},[e.createElementVNode("view",{class:"key delete",onClick:V},[e.createElementVNode("text",null,"Delete")]),e.createElementVNode("view",{class:"key zero",onClick:a[1]||(a[1]=e=>S("0"))},[e.createElementVNode("text",null,"0")]),e.createElementVNode("view",{class:"key confirm",onClick:C},[e.createElementVNode("text",null,"Confirm")])])])])])):e.createCommentVNode("",!0)]))}},Pt={__name:"order",setup(a){const n=[{type:"all",name:"All"},{type:"unpaid",name:"Unpaid"},{type:"notstarted",name:"Not Started"},{type:"ongoing",name:"Ongoing"},{type:"completed",name:"Completed"}],o=e.ref("all"),s=e.ref([]),i=[{id:1,user:{id:1,name:"name1",email:"1550320492@qq.com"},scooter:{id:1,station:{id:1,name:"Chunxi Road Station",latitude:30.6586,longitude:104.0757}},totalCost:60,status:3,payed:1,startTime:"2025-03-13T11:04:41.605087",endTime:"2025-03-13T22:04:41.605087"},{id:2,user:{id:1,name:"name1",email:"1550320492@qq.com"},scooter:{id:2,station:{id:2,name:"Academy Street Station",latitude:30.6678,longitude:104.0873}},totalCost:80,status:0,payed:0,startTime:"2025-04-13T09:00:00",endTime:"2025-04-13T21:00:00"},{id:3,user:{id:1,name:"name1",email:"1550320492@qq.com"},scooter:{id:3,station:{id:3,name:"Shuangshui Street Station",latitude:30.7048,longitude:104.0731}},totalCost:100,status:1,payed:1,startTime:"2025-04-12T14:00:00",endTime:"2025-04-13T14:00:00"},{id:4,user:{id:1,name:"name1",email:"1550320492@qq.com"},scooter:{id:4,station:{id:4,name:"Tianfu Square Station",latitude:30.6571,longitude:104.0657}},totalCost:70,status:4,payed:1,startTime:"2025-04-15T10:00:00",endTime:"2025-04-15T22:00:00"}],l=async()=>{try{const a=uni.getStorageSync("userInfo");if(!a)return void uni.showToast({title:"Please login first",icon:"none"});const n=JSON.parse(a).id;try{const e=await gt.get(`${ht}/user/book/${n}`);if(t("log","at pages/order/order.vue:127",e),200!==e.data.statusCode)throw new Error("Failed to get order data");{let t=e.data.data;switch(o.value){case"unpaid":t=t.filter((e=>0===e.payed));break;case"notstarted":t=t.filter((e=>1===e.status));break;case"ongoing":t=t.filter((e=>2===e.status));break;case"completed":t=t.filter((e=>3===e.status))}s.value=t}}catch(e){t("error","at pages/order/order.vue:151","Failed to get order data, using mock data:",e);let a=i;switch(o.value){case"unpaid":a=a.filter((e=>0===e.payed));break;case"ongoing":a=a.filter((e=>2===e.status));break;case"completed":a=a.filter((e=>3===e.status));break;case"notstarted":a=a.filter((e=>1===e.status))}s.value=a,uni.showToast({title:"Failed to get orders, showing local data",icon:"none"})}}catch(e){t("error","at pages/order/order.vue:177","Failed to get order list:",e),uni.showToast({title:"Failed to get orders",icon:"none"})}},c=(e,t)=>{const a={0:"Unpaid",1:"Not Started",2:"Ongoing",3:"Completed",4:"Cancelled"}[e]||"Unknown";return 4===e?"Cancelled":0===t?`${a} (Unpaid)`:a},d=e=>{const t=new Date(e);return`${t.getFullYear()}.${String(t.getMonth()+1).padStart(2,"0")}.${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},u=(e,t)=>{const a=new Date(e),n=new Date(t)-a,o=Math.floor(n/1e3/60);if(o<60)return`${o} minutes`;return`${Math.floor(o/60)} hours ${o%60} minutes`},m=e=>{uni.navigateTo({url:`/pages/order/detail?id=${e}`})},p=()=>{uni.navigateBack()},g=()=>{uni.showToast({title:"Invoice feature in development",icon:"none"})};return e.onMounted((()=>{l(),uni.$on("refreshOrderList",(()=>{l()}))})),e.onUnmounted((()=>{uni.$off("refreshOrderList")})),r((e=>{e.type&&(o.value=e.type,l())})),(a,r)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:p},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"My Orders"),e.createElementVNode("text",{class:"right-text",onClick:g},"Invoice")]),e.createElementVNode("view",{class:"tab-bar"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(n,(t=>e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:o.value===t.type}]),key:t.type,onClick:e=>{return a=t.type,o.value=a,void l();var a}},[e.createElementVNode("text",null,e.toDisplayString(t.name),1)],10,["onClick"]))),64))]),e.createElementVNode("view",{class:"order-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(a=>{return e.openBlock(),e.createElementBlock("view",{class:"order-item",key:a.id},[e.createElementVNode("view",{class:"order-header"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("text",{class:"icon"},"🛵"),e.createElementVNode("text",{class:"type"},e.toDisplayString(a.scooter.station.name),1)]),e.createElementVNode("text",{class:e.normalizeClass(["status",(n=a.status,o=a.payed,4===n?"status-cancelled":0===o?"status-unpaid":{0:"status-unpaid",1:"status-notstarted",2:"status-ongoing",3:"status-completed",4:"status-cancelled"}[n]||"")])},e.toDisplayString(c(a.status,a.payed)),3)]),e.createElementVNode("view",{class:"order-body"},[e.createElementVNode("view",{class:"time-info"},[e.createElementVNode("text",{class:"label"},"Duration:"),e.createElementVNode("text",{class:"value"},e.toDisplayString(u(a.startTime,a.endTime)),1)]),e.createElementVNode("view",{class:"time-info"},[e.createElementVNode("text",{class:"label"},"Order Time:"),e.createElementVNode("text",{class:"value"},e.toDisplayString(d(a.startTime)),1)])]),e.createElementVNode("view",{class:"order-footer"},[e.createElementVNode("text",{class:"price"},"¥"+e.toDisplayString(a.totalCost),1),e.createElementVNode("view",{class:"btn-group"},[4===a.status?(e.openBlock(),e.createElementBlock("button",{key:0,class:"detail-btn",onClick:e.withModifiers((e=>m(a.id)),["stop"])},"Details",8,["onClick"])):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[0===a.payed?(e.openBlock(),e.createElementBlock("button",{key:0,class:"pay-btn",onClick:e.withModifiers((e=>(e=>{t("log","at pages/order/order.vue:246","Preparing to navigate to payment page, order ID:",e.id),uni.navigateTo({url:`/pages/pay/pay?id=${e.id}`,success:a=>{t("log","at pages/order/order.vue:250","Navigation successful, passed parameters:",{id:e.id})},fail:e=>{t("error","at pages/order/order.vue:253","Navigation failed:",e)}})})(a)),["stop"])},"Pay Now",8,["onClick"])):e.createCommentVNode("",!0),1===a.status?(e.openBlock(),e.createElementBlock("button",{key:1,class:"cancel-btn",onClick:e.withModifiers((e=>(async e=>{uni.showModal({title:"Cancel Order",content:"Are you sure you want to cancel this order?",confirmText:"Confirm",cancelText:"Cancel",success:async a=>{if(a.confirm)try{if(200!==(await gt.delete(`${ht}/user/book/cancel/${e.id}`)).data.statusCode)throw new Error("Failed to cancel order");uni.showToast({title:"Order cancelled",icon:"success"}),await l()}catch(n){t("error","at pages/order/order.vue:328","Failed to cancel order:",n),uni.showToast({title:"Failed to cancel order",icon:"none"})}}})})(a)),["stop"])},"Cancel",8,["onClick"])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"detail-btn",onClick:e.withModifiers((e=>m(a.id)),["stop"])},"Details",8,["onClick"])],64))])])]);var n,o})),128))])]))}},Ot={__name:"detail",setup(a){const n=e.ref(null),o=e.ref({latitude:30.65742,longitude:104.06584,markers:[]}),s=e.ref(null),i=async e=>{var a,r,s,i;try{const s=uni.getStorageSync("userInfo");t("log","at pages/order/detail.vue:20","本地存储的用户信息字符串:",s);const i=JSON.parse(s);if(t("log","at pages/order/detail.vue:22","解析后的用户信息对象:",i),t("log","at pages/order/detail.vue:23","userInfo的类型:",typeof i),t("log","at pages/order/detail.vue:24","userInfo的所有属性:",Object.keys(i)),t("log","at pages/order/detail.vue:25","userInfo.id的值:",i.id),t("log","at pages/order/detail.vue:26","userInfo.id的类型:",typeof i.id),!i||void 0===i.id||null===i.id)throw new Error("User not logged in");t("log","at pages/order/detail.vue:31",e);const l=await gt.get(`${ht}/user/book/id/${e}`);if(t("log","at pages/order/detail.vue:35","Order ID:",e),t("log","at pages/order/detail.vue:36","API response data:",l.data),200===l.status&&l.data.data){if(n.value=l.data.data,null==(r=null==(a=n.value)?void 0:a.scooter)?void 0:r.station){const e=n.value.scooter.station;o.value.latitude=e.latitude,o.value.longitude=e.longitude,o.value.markers=[{id:e.id,latitude:e.latitude,longitude:e.longitude,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:e.name,color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}}]}return}}catch(l){t("warn","at pages/order/detail.vue:65","API request failed, using mock data:",l);const a={1:{id:1,user:{id:1,name:"name1",email:"1550320492@qq.com"},scooter:{id:1,station:{id:1,name:"Chunxi Road Station",latitude:30.6586,longitude:104.0757}},totalCost:60,status:3,payed:1,startTime:"2025-03-13T11:04:41.605087",endTime:"2025-03-13T22:04:41.605087"}}[e];if(!a)throw new Error("Order does not exist");if(n.value=a,null==(i=null==(s=n.value)?void 0:s.scooter)?void 0:i.station){const e=n.value.scooter.station;o.value.latitude=e.latitude,o.value.longitude=e.longitude,o.value.markers=[{id:e.id,latitude:e.latitude,longitude:e.longitude,iconPath:"/static/icons/location.png",width:40,height:40,callout:{content:e.name,color:"#000000",fontSize:14,borderRadius:4,padding:5,display:"ALWAYS"}}]}}};r((e=>{e.id&&(i(e.id),"1"===e.return&&setTimeout((()=>{v()}),500))})),e.onMounted((()=>{s.value&&i(s.value),uni.$on("refreshOrderList",(()=>{s.value&&i(s.value)}))})),e.onUnmounted((()=>{uni.$off("refreshOrderList")}));const l=e=>{const t=new Date(e);return`${t.getFullYear()}.${String(t.getMonth()+1).padStart(2,"0")}.${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},c=(e,t)=>{const a=new Date(e),n=new Date(t)-a,o=Math.floor(n/1e3/60);if(o<60)return`${o} minutes`;return`${Math.floor(o/60)} hours ${o%60} minutes`},d=()=>{uni.navigateBack({delta:1})},u=()=>{uni.navigateTo({url:`/pages/feedback/feedback?orderId=${n.value.id}&scooterId=${n.value.scooter.id}`,success:()=>{t("log","at pages/order/detail.vue:196","跳转到反馈页面成功")},fail:e=>{t("error","at pages/order/detail.vue:199","跳转失败:",e),uni.showToast({title:"跳转失败",icon:"none"})}})},m=(e,t)=>{const a={0:"Unpaid",1:"Not Started",2:"Ongoing",3:"Completed",4:"Cancelled"}[e]||"Unknown";return 4===e?a:0===t?`${a} (Unpaid)`:a},p=(e,t)=>{const a={0:"status-unpaid",1:"status-notstarted",2:"status-ongoing",3:"status-completed",4:"status-cancelled"};return 4===e?a[e]:0===t?"status-unpaid":a[e]||""},g=()=>{uni.showModal({title:"Cancel Order",content:"Are you sure you want to cancel this order?",confirmText:"Confirm",cancelText:"Cancel",success:async e=>{if(e.confirm)try{const e=await uni.request({url:`${ht}/user/book/cancel/${n.value.id}`,method:"DELETE"});if(200!==e.statusCode)throw new Error("Error");n.value=e.data.data,uni.showToast({title:"Order has been cancelled",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(a){t("error","at pages/order/detail.vue:271","Error:",a),uni.showToast({title:"Error",icon:"none"})}}})},h=e.ref(!1),f=e.ref(""),v=()=>{t("log","at pages/order/detail.vue:288",1),h.value=!0},y=()=>{f.value="",h.value=!1},w=async()=>{if(f.value)try{if(200!==(await gt.post(`${ht}/user/book/complete`,{bookId:n.value.id,newStationId:parseInt(f.value)})).data.statusCode)throw new Error("Return failed");uni.showToast({title:"Success",icon:"success"}),y(),await i(n.value.id),uni.$emit("refreshOrderList"),setTimeout((()=>{uni.navigateBack()}),1500)}catch(e){t("error","at pages/order/detail.vue:335","Return failed:",e),uni.showToast({title:"Return failed, please check station code",icon:"none"})}else uni.showToast({title:"Please enter station code",icon:"none"})},E=e.ref(!1),b=e.ref(1),k=[1,2,4,6,8,10,12,24],N=()=>{E.value=!0},S=()=>{b.value=1,E.value=!1},V=async()=>{try{if(200!==(await uni.request({url:`${ht}/user/book/extend`,method:"POST",data:{bookId:n.value.id,extendHours:b.value}})).statusCode)throw new Error("Extend order failed");uni.showToast({title:"Success",icon:"success"}),S(),await i(n.value.id),uni.$emit("refreshOrderList")}catch(e){t("error","at pages/order/detail.vue:387","Extend order failed:",e),uni.showToast({title:"Extend order failed",icon:"none"})}},C=()=>{t("log","at pages/order/detail.vue:397","Preparing to navigate to payment page, order ID:",n.value.id),uni.navigateTo({url:`/pages/pay/pay?id=${n.value.id}`,success:e=>{t("log","at pages/order/detail.vue:401","Navigation successful, passed parameters:",{id:n.value.id})},fail:e=>{t("error","at pages/order/detail.vue:404","Navigation failed:",e)}})};return(t,a)=>{var r,s,i,x;return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:e.withModifiers(d,["stop"])},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"Order Details")]),e.createElementVNode("view",{class:"map-container"},[e.createElementVNode("map",{id:"map",class:"map",latitude:o.value.latitude,longitude:o.value.longitude,markers:o.value.markers,scale:16,"show-location":""},null,8,["latitude","longitude","markers"])]),n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"order-card"},[e.createElementVNode("view",{class:"info-section"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"Order ID"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.value.id),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"Status"),e.createElementVNode("text",{class:e.normalizeClass(["value",p(n.value.status,n.value.payed)])},e.toDisplayString(m(n.value.status,n.value.payed)),3)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"Station"),e.createElementVNode("text",{class:"value"},e.toDisplayString(n.value.scooter.station.name),1)]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"label"},"Duration"),e.createElementVNode("text",{class:"value"},e.toDisplayString(c(n.value.startTime,n.value.endTime)),1)])]),e.createElementVNode("view",{class:"time-section"},[e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"label"},"Start Time"),e.createElementVNode("text",{class:"value"},e.toDisplayString(l(n.value.startTime)),1)]),e.createElementVNode("view",{class:"time-item"},[e.createElementVNode("text",{class:"label"},"End Time"),e.createElementVNode("text",{class:"value"},e.toDisplayString(l(n.value.endTime)),1)])]),e.createElementVNode("view",{class:"cost-section"},[e.createElementVNode("view",{class:"cost-item"},[e.createElementVNode("text",{class:"label"},"Cost"),e.createElementVNode("text",{class:"value price"},"¥"+e.toDisplayString(n.value.totalCost),1)])])])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"bottom-buttons"},[2===(null==(r=n.value)?void 0:r.status)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("button",{class:"extend-btn",onClick:N},"Extend"),e.createElementVNode("button",{class:"return-btn",onClick:v},"Return")],64)):e.createCommentVNode("",!0),0===(null==(s=n.value)?void 0:s.payed)&&4!==(null==(i=n.value)?void 0:i.status)?(e.openBlock(),e.createElementBlock("button",{key:1,class:"pay-btn",onClick:C},"Pay Now")):e.createCommentVNode("",!0),1===(null==(x=n.value)?void 0:x.status)?(e.openBlock(),e.createElementBlock("button",{key:2,class:"cancel-btn",onClick:g},"Cancel")):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"report-btn",onClick:u},"Report")]),h.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"modal"},[e.createElementVNode("view",{class:"modal-mask",onClick:y}),e.createElementVNode("view",{class:"return-modal"},[e.createElementVNode("view",{class:"modal-title"},"Enter Station Code"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e),placeholder:"Enter station code",class:"station-input"},null,512),[[e.vModelText,f.value]]),e.createElementVNode("view",{class:"modal-buttons"},[e.createElementVNode("button",{class:"modal-btn cancel",onClick:y},"Cancel"),e.createElementVNode("button",{class:"modal-btn confirm",onClick:w},"Confirm")])])])):e.createCommentVNode("",!0),E.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"modal"},[e.createElementVNode("view",{class:"modal-mask",onClick:S}),e.createElementVNode("view",{class:"extend-modal"},[e.createElementVNode("view",{class:"modal-title"},"Select Extension Time"),e.createElementVNode("view",{class:"hours-options"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(k,(t=>e.createElementVNode("view",{key:t,class:e.normalizeClass(["hours-item",{active:b.value===t}]),onClick:e=>b.value=t},[e.createElementVNode("text",null,e.toDisplayString(t)+"h",1)],10,["onClick"]))),64))]),e.createElementVNode("view",{class:"modal-buttons"},[e.createElementVNode("button",{class:"modal-btn cancel",onClick:S},"Cancel"),e.createElementVNode("button",{class:"modal-btn confirm",onClick:V},"Confirm")])])])):e.createCommentVNode("",!0)])}}},At={__name:"card",setup(a){const n=["Industrial and Commercial Bank of China","Agricultural Bank of China","Bank of China","China Construction Bank","Bank of Communications","China Merchants Bank","China CITIC Bank","China Minsheng Bank","China Everbright Bank","Shanghai Pudong Development Bank"],o=e.ref({holderName:"Zhang San",cardNumber:"6222021234567890123",bankName:"Industrial and Commercial Bank of China",expiryMonth:"12",expiryYear:"25",cvv:"123"}),r=e.ref(0),s=e=>{r.value=e.detail.value,o.value.bankName=n[e.detail.value]},i=async()=>{var e,a,n;if(l())try{const e=uni.getStorageSync("userInfo");if(t("log","at pages/card/card.vue:47","存储的用户信息字符串:",e),!e)return void uni.showToast({title:"Please log in first",icon:"none"});let a;try{a=JSON.parse(e),t("log","at pages/card/card.vue:60","解析后的用户信息:",a)}catch(r){return t("error","at pages/card/card.vue:62","解析用户信息失败:",r),void uni.showToast({title:"用户信息格式错误，请重新登录",icon:"none"})}if(!a||!a.id)return t("error","at pages/card/card.vue:71","用户信息缺少ID:",a),void uni.showToast({title:"用户信息无效，请重新登录",icon:"none"});t("log","at pages/card/card.vue:78",a.id);const n=await gt.post(`${ht}/user/card`,{id:a.id,card:o.value.cardNumber});if(t("log","at pages/card/card.vue:86","API响应:",n.data),200!==n.data.statusCode)throw new Error(n.data.message||"Binding failed");{const e={...a,card:{cardNumber:o.value.cardNumber,holderName:o.value.holderName,bankName:o.value.bankName,expiryMonth:o.value.expiryMonth,expiryYear:o.value.expiryYear}};uni.setStorageSync("userInfo",JSON.stringify(e)),t("log","at pages/card/card.vue:103","更新后的用户信息:",e),uni.showToast({title:"Binding successful",icon:"success",duration:1500}),setTimeout((()=>{uni.navigateBack({delta:1,success:()=>{const e=getCurrentPages(),t=e[e.length-1];t&&t.$vm&&t.$vm.refreshPage&&t.$vm.refreshPage()}})}),1500)}}catch(s){t("error","at pages/card/card.vue:131","绑定银行卡失败:",s),t("error","at pages/card/card.vue:132","错误详情:",(null==(e=s.response)?void 0:e.data)||s.message),uni.showToast({title:(null==(n=null==(a=s.response)?void 0:a.data)?void 0:n.message)||s.message||"Binding failed",icon:"none"})}},l=()=>{const{holderName:e,cardNumber:t,bankName:a,expiryMonth:n,expiryYear:r,cvv:s}=o.value;return e?!t||t.length<16?(uni.showToast({title:"Please enter a valid card number",icon:"none"}),!1):a?n&&r?!(!s||3!==s.length)||(uni.showToast({title:"Please enter a valid security code",icon:"none"}),!1):(uni.showToast({title:"Please enter expiry date",icon:"none"}),!1):(uni.showToast({title:"Please select a bank",icon:"none"}),!1):(uni.showToast({title:"Please enter cardholder name",icon:"none"}),!1)},c=()=>{uni.navigateBack()};return e.onMounted((()=>{r.value=n.indexOf(o.value.bankName)})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"card-container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:c},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"Bind Bank Card")]),e.createElementVNode("view",{class:"card-form"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Cardholder"),e.withDirectives(e.createElementVNode("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>o.value.holderName=e),placeholder:"Please enter cardholder name",class:"input"},null,512),[[e.vModelText,o.value.holderName]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Card Number"),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>o.value.cardNumber=e),placeholder:"Please enter card number",class:"input"},null,512),[[e.vModelText,o.value.cardNumber]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Bank"),e.createElementVNode("picker",{range:n,value:r.value,onChange:s,class:"picker"},[e.createElementVNode("view",{class:"picker-value"},e.toDisplayString(o.value.bankName||"Please select bank"),1)],40,["value"])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Expiry Date"),e.createElementVNode("view",{class:"expiry-inputs"},[e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[2]||(a[2]=e=>o.value.expiryMonth=e),placeholder:"MM",class:"input expiry",maxlength:"2"},null,512),[[e.vModelText,o.value.expiryMonth]]),e.createElementVNode("text",{class:"separator"},"/"),e.withDirectives(e.createElementVNode("input",{type:"number","onUpdate:modelValue":a[3]||(a[3]=e=>o.value.expiryYear=e),placeholder:"YY",class:"input expiry",maxlength:"2"},null,512),[[e.vModelText,o.value.expiryYear]])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Security Code"),e.withDirectives(e.createElementVNode("input",{type:"password","onUpdate:modelValue":a[4]||(a[4]=e=>o.value.cvv=e),placeholder:"Please enter 3-digit security code",class:"input",maxlength:"3"},null,512),[[e.vModelText,o.value.cvv]])])]),e.createElementVNode("view",{class:"bottom-bar"},[e.createElementVNode("button",{class:"submit-btn",onClick:i}," Confirm Binding ")])]))}},Dt={__name:"feedback",setup(a){const n=e.ref(""),o=e.ref(null),s=e.ref(null),i=e.ref(""),l=["Battery Issue","Brake Problem","Tire Problem","Light Issue","Handlebar Problem","Other Issues"],c=()=>{uni.navigateBack()},d=async()=>{var e,a,r;if(i.value)if(n.value.trim())try{const e=await gt.post(`${ht}/user/feedback/add`,{bookId:o.value,message:n.value.trim()});if(t("log","at pages/feedback/feedback.vue:103","反馈提交响应:",e),t("log","at pages/feedback/feedback.vue:104","响应数据:",e.data),200!==e.data.statusCode)throw new Error(e.data.message||"Submission failed");uni.showToast({title:"Submitted successfully",icon:"success"}),setTimeout((()=>{uni.navigateBack()}),1500)}catch(s){t("error","at pages/feedback/feedback.vue:118","Failed to submit feedback:",s),t("error","at pages/feedback/feedback.vue:119","错误详情:",(null==(e=s.response)?void 0:e.data)||s.message),uni.showToast({title:(null==(r=null==(a=s.response)?void 0:a.data)?void 0:r.message)||s.message||"Submission failed",icon:"none"})}else uni.showToast({title:"Please enter feedback content",icon:"none"});else uni.showToast({title:"Please select issue type",icon:"none"})};return r((e=>{t("log","at pages/feedback/feedback.vue:129","页面参数:",e),e.orderId&&(o.value=e.orderId),e.scooterId&&(s.value=e.scooterId)})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:c},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"Submit Feedback")]),e.createElementVNode("view",{class:"feedback-form"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Issue Type"),e.createElementVNode("view",{class:"issue-types"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(l,((t,a)=>e.createElementVNode("view",{key:a,class:e.normalizeClass(["issue-type-item",{active:i.value===t}]),onClick:e=>(e=>{i.value=e})(t)},[e.createElementVNode("text",null,e.toDisplayString(t),1)],10,["onClick"]))),64))])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"label"},"Feedback Content"),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>n.value=e),placeholder:"Please describe the issue in detail",maxlength:"500",class:"feedback-textarea"},null,512),[[e.vModelText,n.value]]),e.createElementVNode("text",{class:"word-count"},e.toDisplayString(n.value.length)+"/500",1)])]),e.createElementVNode("view",{class:"submit-section"},[e.createElementVNode("button",{class:"submit-btn",onClick:d},"Submit")])]))}},Ft={__name:"list",setup(a){const n=e.ref([]),o=e=>{if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},r=e=>({"未处理":"Pending","处理中":"Processing","已处理":"Resolved"}[e]||e),s=()=>{uni.navigateBack()};return e.onMounted((()=>{(async()=>{try{const e=uni.getStorageSync("userInfo");if(!e)return void uni.showToast({title:"Please login first",icon:"none"});const t=JSON.parse(e),a=await gt.get(`${ht}/user/feedback/${t.id}`);if(200!==a.data.statusCode)throw new Error(a.data.message||"Failed to get feedback list");n.value=a.data.data}catch(e){t("error","at pages/feedback/list.vue:74","Failed to get feedback list:",e),uni.showToast({title:e.message||"Failed to get feedback list",icon:"none"})}})()})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{class:"feedback-list"},[e.createElementVNode("view",{class:"nav-bar"},[e.createElementVNode("view",{class:"back-btn",onClick:s},[e.createElementVNode("text",{class:"iconfont icon-back"},"×")]),e.createElementVNode("text",{class:"title"},"My Feedback")]),e.createElementVNode("view",{class:"feedback-container"},[0===n.value.length?(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty-state"},[e.createElementVNode("text",null,"No feedback records")])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"feedback-items"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,(t=>{return e.openBlock(),e.createElementBlock("view",{key:t.id,class:"feedback-item"},[e.createElementVNode("view",{class:"feedback-header"},[e.createElementVNode("view",{class:"header-left"},[e.createElementVNode("text",{class:"station-name"},e.toDisplayString(t.book.scooter.station.name),1),e.createElementVNode("text",{class:"feedback-time"},e.toDisplayString(o(t.createTime)),1)]),e.createElementVNode("text",{class:e.normalizeClass(["feedback-status",(a=t.status,{Pending:"status-pending",Processing:"status-processing",Resolved:"status-resolved"}[r(a)]||"")])},e.toDisplayString(r(t.status)),3)]),e.createElementVNode("view",{class:"feedback-content"},[e.createElementVNode("view",{class:"feedback-message"},[e.createElementVNode("text",{class:"label"},"Feedback:"),e.createElementVNode("text",{class:"content"},e.toDisplayString(t.message),1)]),t.result?(e.openBlock(),e.createElementBlock("view",{key:0,class:"feedback-result"},[e.createElementVNode("text",{class:"label"},"Result:"),e.createElementVNode("text",{class:"content"},e.toDisplayString(t.result),1)])):e.createCommentVNode("",!0)])]);var a})),128))]))])]))}};__definePage("pages/index/index",ft),__definePage("pages/login/login",yt),__definePage("pages/register/register",wt),__definePage("pages/user/user",bt),__definePage("pages/rent/rent",Bt),__definePage("pages/pay/pay",Rt),__definePage("pages/order/order",Pt),__definePage("pages/order/detail",Ot),__definePage("pages/card/card",At),__definePage("pages/feedback/feedback",Dt),__definePage("pages/feedback/list",Ft);const _t={onLaunch:function(){t("log","at App.vue:5","App Launch")},onShow:function(){t("log","at App.vue:8","App Show")},onHide:function(){t("log","at App.vue:11","App Hide")}};const{app:$t,Vuex:Lt,Pinia:Mt}={app:e.createVueApp(_t)};uni.Vuex=Lt,uni.Pinia=Mt,$t.provide("__globalStyles",__uniConfig.styles),$t._component.mpType="app",$t._component.render=()=>{},$t.mount("#app")}(Vue);
